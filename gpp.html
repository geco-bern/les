<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Land in the Earth System - 4&nbsp; Gross primary production and photosynthesis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ecosystemcarbon.html" rel="next">
<link href="./globalcarbonbudget.html" rel="prev">
<link href="./figures/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Land in the Earth System - 4&nbsp; Gross primary production and photosynthesis">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="images/light_absorption_bonan.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/geco-bern/les_i/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part1.html">Part I</a></li><li class="breadcrumb-item"><a href="./gpp.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Gross primary production and photosynthesis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./biogeography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Biogeography</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./globalcarbonbudget.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The global carbon budget</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gpp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Gross primary production and photosynthesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecosystemcarbon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ecosystem carbon dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./globalcarbonpatterns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial and temporal patterns of the terrestrial carbon cycle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./landclimate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Land-climate interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecohydrology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ecohydrology</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feedbacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Earth system feedbacks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./landusechange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Land use change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nutrients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Carbon-nutrient cycle interactions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ghg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Terrestrial greenhouse gas emissions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./globenvchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Global environmental change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./oceancarbon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ocean CO<sub>2</sub> uptake and emission-concentration trajectories</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#light-use-efficiency-model" id="toc-light-use-efficiency-model" class="nav-link active" data-scroll-target="#light-use-efficiency-model"><span class="header-section-number">4.1</span> Light use efficiency model</a></li>
  <li><a href="#sec-light-absorption" id="toc-sec-light-absorption" class="nav-link" data-scroll-target="#sec-light-absorption"><span class="header-section-number">4.2</span> Canopy light absorption</a></li>
  <li><a href="#sec-photosynthesis" id="toc-sec-photosynthesis" class="nav-link" data-scroll-target="#sec-photosynthesis"><span class="header-section-number">4.3</span> Photosynthesis</a>
  <ul class="collapse">
  <li><a href="#light-absorption-at-the-cellular-level" id="toc-light-absorption-at-the-cellular-level" class="nav-link" data-scroll-target="#light-absorption-at-the-cellular-level"><span class="header-section-number">4.3.1</span> Light absorption at the cellular level</a></li>
  <li><a href="#light-reactions" id="toc-light-reactions" class="nav-link" data-scroll-target="#light-reactions"><span class="header-section-number">4.3.2</span> Light reactions</a></li>
  <li><a href="#sec-calvin-cycle" id="toc-sec-calvin-cycle" class="nav-link" data-scroll-target="#sec-calvin-cycle"><span class="header-section-number">4.3.3</span> Calvin cycle</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.3.4</span> Summary</a></li>
  <li><a href="#sec-fvcb" id="toc-sec-fvcb" class="nav-link" data-scroll-target="#sec-fvcb"><span class="header-section-number">4.3.5</span> Response to light and CO<sub>2</sub></a></li>
  <li><a href="#sec-ftemp" id="toc-sec-ftemp" class="nav-link" data-scroll-target="#sec-ftemp"><span class="header-section-number">4.3.6</span> Response to temperature</a></li>
  <li><a href="#adptation-and-acclimation-of-topt" id="toc-adptation-and-acclimation-of-topt" class="nav-link" data-scroll-target="#adptation-and-acclimation-of-topt"><span class="header-section-number">4.3.7</span> Adptation and acclimation of <em>T</em><sub>opt</sub></a></li>
  <li><a href="#sec-c4" id="toc-sec-c4" class="nav-link" data-scroll-target="#sec-c4"><span class="header-section-number">4.3.8</span> C<sub>4</sub> photosynthesis</a></li>
  </ul></li>
  <li><a href="#sec-transpiration" id="toc-sec-transpiration" class="nav-link" data-scroll-target="#sec-transpiration"><span class="header-section-number">4.4</span> Transpiration and leaf water-carbon coupling</a>
  <ul class="collapse">
  <li><a href="#sec-wue" id="toc-sec-wue" class="nav-link" data-scroll-target="#sec-wue"><span class="header-section-number">4.4.1</span> Water use efficiency</a></li>
  <li><a href="#sec-carbon-isotopes" id="toc-sec-carbon-isotopes" class="nav-link" data-scroll-target="#sec-carbon-isotopes"><span class="header-section-number">4.4.2</span> Isotopic fractionation</a></li>
  <li><a href="#sec-stomatalregulation" id="toc-sec-stomatalregulation" class="nav-link" data-scroll-target="#sec-stomatalregulation"><span class="header-section-number">4.4.3</span> Stomatal regulation</a></li>
  </ul></li>
  <li><a href="#sec-constlue" id="toc-sec-constlue" class="nav-link" data-scroll-target="#sec-constlue"><span class="header-section-number">4.5</span> From photosynthesis to light use efficiency</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-gpp" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Gross primary production and photosynthesis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In <a href="globalcarbonbudget.html"><span>Chapter&nbsp;3</span></a>, we conceived the global carbon cycle as a system of three pools (atmosphere, land, ocean), emissions as fluxes into the system (added to the atmosphere), and fluxes between the pools. The C dynamics in the land biosphere were modeled using a 1-box model which receives C inputs through photosynthesis and loses C through a constant turnover. In this chapter, we dive deeper into the processes that drive photosynthetic carbon uptake by land ecosystems.</p>
<section id="light-use-efficiency-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="light-use-efficiency-model"><span class="header-section-number">4.1</span> Light use efficiency model</h2>
<p><span class="citation" data-cites="monteith72">Monteith (<a href="references.html#ref-monteith72" role="doc-biblioref">1972</a>)</span> made the observation that the biomass productivity of a given (well-watered) crop (in the tropics) scales linearly with the amount of absorbed solar radiation, integrated over weeks to months. This observation underlies the general light use efficiency (LUE) model which describes ecosystem-level apparent photosynthesis (referred to as <em>gross primary production</em>, GPP) as the photosynthetic photon flux density (PPFD) and the efficiency at which photons are used for assimilating C (LUE). <span id="eq-luemodel"><span class="math display">\[
\mathrm{GPP} = \mathrm{PPFD} \cdot \mathrm{fAPAR} \cdot \mathrm{LUE}
\tag{4.1}\]</span></span> GPP is expressed as a C flux per unit ground area and per unit time (e.g., gC m<sup>-2</sup> s<sup>-1</sup>). PPFD measures the solar radiation flux, incident at the top of the canopy. It is expressed, e.g., in units of mol (photons) m<sup>-2</sup> s<sup>-1</sup>. The light use efficiency model (<a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>) is also often formulated using the photosynthetically active (solar) radiation (PAR) in units of an energy flux per unit ground area (e.g., W m<sup>-2</sup>), instead of PPFD. This is equivalent to the expression with respect to PPFD, considering that each photon (light quantum) bears a certain amount of radiation energy (see, e.g., <a href="https://en.wikipedia.org/wiki/Photon_energy">here</a>). fAPAR is the fraction (unitless) of absorbed photosynthetically active radiation. It depends on the total ecosystem-level (or canopy-level) surface area of green leaves (<a href="#sec-light-absorption"><span>Section&nbsp;4.2</span></a>). LUE is the light use efficiency, measuring the efficiency with which photons are harvested and used for assimilating CO<sub>2</sub> by the photosynthetic machinery (<a href="#sec-photosynthesis"><span>Section&nbsp;4.3</span></a>). It is expressed, e.g., in units of gC (mol CO<sub>2</sub>)<sup>-1</sup>. See <a href="#tbl-symbols-gpp">Table&nbsp;<span>4.1</span></a> for an overview of symbols and abbreviations used in this chapter.</p>
<p>Of course, a relationship with biomass productivity, as observed by <span class="citation" data-cites="monteith72">Monteith (<a href="references.html#ref-monteith72" role="doc-biblioref">1972</a>)</span> should not be equated with a relationship with GPP. However, again, over longer periods of time, a given plant converts assimilated carbon into biomass at a relatively constant rate (see <a href="ecosystemcarbon.html"><span>Chapter&nbsp;5</span></a>). Therefore, the observation by <span class="citation" data-cites="monteith72">Monteith (<a href="references.html#ref-monteith72" role="doc-biblioref">1972</a>)</span> is instructive for our understanding. Indeed, models of terrestrial GPP are often formulated in the form of <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a> and are useful for estimating how GPP values over space and time (at the scale of weeks to months). The aspect that the observations by <span class="citation" data-cites="monteith72">Monteith (<a href="references.html#ref-monteith72" role="doc-biblioref">1972</a>)</span> were made under well-watered conditions is a further caveat. However, it shall serve us in this chapter as we are - for now - ignoring the effects by limited root-zone water availability. We will relieve this simplification in <a href="landclimate.html"><span>Chapter&nbsp;7</span></a> and <a href="ecohydrology.html"><span>Chapter&nbsp;8</span></a>.</p>
<p>The linear dependence of GPP on PPFD implies that the variations of solar radiation over the seasons and across latitude directly translate to how GPP varies across these scales. This will be further described in <a href="globalcarbonpatterns.html"><span>Chapter&nbsp;6</span></a>. Note that at shorter time scales, GPP is no longer linearly related to PAR. Through its influence on GPP, as described by <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>, solar radiation is the “engine” of photosynthetic CO<sub>2</sub> uptake by the terrestrial ecosystems. Temporal and spatial patterns of GPP are strongly driven by patterns in solar radiation. The astronomical mechanics responsible for temporal and spatial (latitudinal) patterns in solar radiation will be introduced in <a href="globalcarbonpatterns.html"><span>Chapter&nbsp;6</span></a>. For now, let’s remember that the incoming (incident) solar radiation is an energy flux that varies strongly over the course of a day and a year. These diurnal and seasonal patterns are different along different latitudes (position north or south of the Equator). In the following, we delve deeper into the two factors fAPAR and LUE in <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>.</p>
</section>
<section id="sec-light-absorption" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-light-absorption"><span class="header-section-number">4.2</span> Canopy light absorption</h2>
<p>Photosynthetic CO<sub>2</sub> uptake only operates if active (green) leaves are out. The relationship between the amount of leaves and GPP is introduced here. Active leaf area varies across the seasons and space in response to the seasonality of temperature, light and water availability. The seasonal fluctuation of leaf area, most visible for deciduous trees, is referred to as (leaf) phenology. The drivers of temporal and spatial variations of phenology and leaf area are introduced in <a href="globalcarbonpatterns.html#sec-phenology"><span>Section&nbsp;6.2</span></a>.</p>
<p>The fraction of absorbed photosynthetically active radiation (fAPAR) increases with the projected (one-sided) surface area of leaves per unit ground area (the <em>leaf area index</em>, LAI). The total surface area of leaves is roughly twice the projected surface area. The LAI is an ecosystem-level variable and reflects the leaf area density of the whole canopy. The canopy may be composed of multiple species and organised in multiple canopy layers (<a href="#fig-light_absorption">Figure&nbsp;<span>4.1</span></a>). While temperate and boreal forests commonly form a single understorey and attain LAI values of 4-6 m<sup>2</sup> m<sup>-1</sup>, tropical moist forests may have multiple canopy layers and an LAI of over 6 m<sup>2</sup> m<sup>-1</sup> (<a href="biogeography.html#fig-lai">Figure&nbsp;<span>2.16</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-light_absorption" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/light_absorption_bonan.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Vertical profile of the leaf area index (LAI) and light absorption the canopy for a typical oak forest, where most leaves are located in a dense canopy without an understorey. Figure from <span class="citation" data-cites="bonan">Bonan (<a href="references.html#ref-bonan" role="doc-biblioref">2015</a>)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>While the intensity of shortwave (solar) radiation is highest at the top of the canopy, it is progressively attenuated as it penetrates into the canopy. Radiation gets reflected, absorbed and transmitted by individual leaves. The penetration of radiation into a canopy is referred to as canopy <em>radiative transfer</em>. Each of the processes - reflection, absorption, and transmittance - affects light differently in different wavelengths, depends on the solar zenith angle, on the three-dimensional arrangement of leaves in the canopy (angles, “clumping”), and on the pigments on the leaf surfaces that are responsible for light absorption. Pigments change across species and may vary in response to stress (e.g., by frost, heat, or water limitation).</p>
<p>In brief, canopy radiative transfer is complex. A simple model for how (solar) radiation (light) is attenuated as it penetrates into the canopy is given by the <em>Beer-Lambert law</em>. To apply it for canopy radiative transfer, we assume that a leaf only <em>absorbs</em> light, but does not reflect or transmit it. Following this model, the light intensity <span class="math inline">\(I\)</span> at the bottom of the canopy (<span class="math inline">\(z_0\)</span>) is an exponential function of LAI (<span class="math inline">\(L\)</span>). The rate of decline of the light intensity is given by the light extinction coefficient <span class="math inline">\(k\)</span>. A typical value of <span class="math inline">\(k\)</span> in the visible (photosynthetically active) wavelength spectrum is 0.5. <span class="math display">\[
I(z_0) = I_0 \; e^{-kL}
\]</span> We have assumed that no light is reflected. Therefore the reduction of light levels at the bottom of the canopy tells us how much light was absorbed by the canopy (and used for photosynthesis). The fraction of absorbed (photosynthetically active) radiation therefore is <span class="math display">\[
\begin{align}
\mathrm{fAPAR} &amp;= 1 - I(z_0)/I_0 \\
               &amp;= 1 - e^{-kL}\;.
\end{align}
\]</span></p>
<p>The shape of this function is illuatrated in <a href="#fig-fapar">Figure&nbsp;<span>4.2</span></a> (a). This implies a dependency of light levels on canopy depth <span class="math inline">\(z\)</span>, as illustrated in <a href="#fig-fapar">Figure&nbsp;<span>4.2</span></a> (b) - consistent with the observation shown in <a href="#fig-light_absorption">Figure&nbsp;<span>4.1</span></a> (b).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>calc_fapar <span class="ot">&lt;-</span> <span class="cf">function</span>(lai, k_beer){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k_beer <span class="sc">*</span> lai)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>gg_fapar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> calc_fapar, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">k_beer =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.75</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"LAI (m"</span><span class="sc">^</span><span class="dv">2</span>, <span class="st">" m"</span><span class="sc">^-</span><span class="dv">2</span>, <span class="st">")"</span>)),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"fAPAR (unitless)"</span>) <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>calc_cumlai <span class="ot">&lt;-</span> <span class="cf">function</span>(z){</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(z <span class="sc">&lt;=</span> <span class="fl">3.5</span>, z<span class="sc">*</span><span class="fl">4.6</span><span class="sc">/</span><span class="fl">3.5</span>, <span class="fl">4.6</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>calc_light_rel <span class="ot">&lt;-</span> <span class="cf">function</span>(z, k_beer){</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>k_beer <span class="sc">*</span> <span class="fu">calc_cumlai</span>(z))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">z =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">light_rel =</span> <span class="fu">calc_light_rel</span>(z, <span class="at">k_beer =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>gg_canopydepth <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">1</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">3.5</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#009E73"</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> <span class="fl">0.45</span>, <span class="at">xmax =</span> <span class="fl">0.55</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fl">3.5</span>, <span class="at">ymax =</span> <span class="dv">7</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"sienna"</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> z,</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> light_rel),</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#E69F00"</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Canopy depth (m)"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Light level (relative)"</span>) <span class="sc">+</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  gg_fapar,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  gg_canopydepth,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fapar" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gpp_files/figure-html/fig-fapar-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: The fraction of absorbed photosynthetically active radiation (fAPAR) as a function of LAI (a) and relative light (or photosynthetically active radiation) levels as a function of canopy depth (z) following the Beer-Lambert law. The arrangement of the canopy versus depth (z = 0 at the top of the canopy) is shown by the green rectangle in (b), within which leaves are assumed to be evenly distributed. The yellow line in (b) represents the light levels, relative to the top of the canopy. The brown rectangle represents a stem, indicating that this part is below the canopy - without light-absorbing leaves.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Basis of the Beer-Lambert law for canopy light extinction
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Following the Beer-Lambert law model, the light extinction at canopy depth <span class="math inline">\(z\)</span> (measuring from the top) is proportional to the light intensity at that depth and an “optical density” <span class="math inline">\(\mu\)</span>. <span id="eq-optical-density"><span class="math display">\[
\frac{\mathrm{d}I}{\mathrm{d}z} = -\mu\;I(z)
\tag{4.2}\]</span></span> Therefore, the light intensity declines exponentially with <span class="math inline">\(z\)</span>. <span id="eq-light-extinction"><span class="math display">\[
I(z) = I_0 \exp(-\mu z)
\tag{4.3}\]</span></span> How does the dependency on <span class="math inline">\(z\)</span> relate to the dependency on LAI (<span class="math inline">\(L\)</span>)?</p>
<p>For applying the Beer Lambert law, it is further assumed that the canopy is a homogenous turbid medium. In other words, we assume that leaves are uniformly distributed across the canopy and that the optical density is given by the leaf area index <span class="math inline">\(L\)</span> divided by the total canopy depth <span class="math inline">\(z_0\)</span>: <span id="eq-homogenous-canopy"><span class="math display">\[
\mu = k \frac{L}{z_0}
\tag{4.4}\]</span></span> <span class="math inline">\(k\)</span> is the leaf area-specific optical density, or <em>light extinction coefficient</em>. Using <a href="#eq-light-extinction">Equation&nbsp;<span>4.3</span></a> and <a href="#eq-homogenous-canopy">Equation&nbsp;<span>4.4</span></a>, we can thus express the light level at the bottom of the canopy (<span class="math inline">\(z_0\)</span>) as a function of <span class="math inline">\(L\)</span> as <span class="math display">\[
I(z_0) = I_0 \; e^{-kL}
\]</span> and the fraction of absorbed (photosynthetically active) radiation is <span class="math display">\[
\mathrm{fAPAR} = 1 - e^{-kL}\;.
\]</span></p>
</div>
</div>
</div>
<p>The radiation <span class="math inline">\(I\)</span> consists of <em>direct</em> radiation from the sun and <em>diffuse</em> radiation from the sky and from radiation scattered within the canopy. This distinction is relevant for understanding radiation absorption by the canopy and canopy-level photosynthesis. Two important implications are the following. First, diffuse radiation is more effectively absorbed by canopies, particularly at low LAI. The reduction of GPP under cloudy conditions is therefore less than what would be expected from considering only changes in <span class="math inline">\(I_0\)</span> (the effective <span class="math inline">\(k\)</span> is higher for diffuse radiation than for direct radiation).</p>
<p>Second, the energy flux of direct radiation is much higher than that of diffuse radiation. Although at greater canopy depths, leaves are more frequently exposed to diffuse than to direct radiation, the latter provides potentially valuable energy for photosynthesis, but occurs very rarely (<em>sunflecks</em>). Leaves have to balance the rare high-intensity light levels and the frequent low-intensity levels for adjusting photosynthetic capacities.</p>
<!-- XXX to add: -->
<!-- - box for Mercado et al. paper on volcanic eruption and the land C sink -->
<!-- XXX for LES II: -->
<!-- 2-stream model (Wohlfahrt code) -->
</section>
<section id="sec-photosynthesis" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-photosynthesis"><span class="header-section-number">4.3</span> Photosynthesis</h2>
<p>Light use efficiency (LUE, <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>) measures the efficiency at which absorbed photons (radiation) are converted into C in the form of sugars. LUE is an ecosystem-level quantity and reflects the collective photosynthetic CO<sub>2</sub> uptake efficiency of all leaves in the canopy. This efficiency is determined by the leaf physiology and the activity of the photosynthetic machinery. In this subsection, we dive very deep into the physiology of photosynthesis.</p>
<!-- XXX add: photosynthetically active radiation (with average wavelength 0.55 μm) is converted from W m–2 (J s–1 m–2) to photosynthetic pho- ton flux density with units μmol photon m–2 s–1 using the factor 4.6 μmol J–1 (Bonan 2015) -->
<p>CO<sub>2</sub> uptake by the leaf happens by diffusion through pores at the leaf surface (<em>stomata</em>, <a href="#fig-stomata">Figure&nbsp;<span>4.3</span></a>). The opening of stomata is dynamically regulated in response to environmental conditions (light, CO<sub>2</sub>, temperature, atmospheric humidity) and controls the conductance to CO<sub>2</sub> diffusion. The CO<sub>2</sub> uptake flux by diffusive transport through stomata can thus be described by <em>Fick’s law</em> which states that the flux is proportional to the concentration difference of CO<sub>2</sub> inside and outside the leaf. <span id="eq-photo-fick"><span class="math display">\[
A = g_s(c_a - c_i)
\tag{4.5}\]</span></span> <span class="math inline">\(c_a\)</span> is the ambient CO<sub>2</sub> concentration (outside the leaf), and <span class="math inline">\(c_i\)</span> is the CO<sub>2</sub> concentration inside the leaf - at the chloroplast. <span class="math inline">\(g_s\)</span> is the stomatal conductance. Note that we use the variable name <span class="math inline">\(A\)</span> here for CO<sub>2</sub> assimilation by photosynthesis. In constrast to the ecosystem-level variable GPP, <span class="math inline">\(A\)</span> refers to the leaf-level flux.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-stomata" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/stomata.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: CO<sub>2</sub> diffuses into the leaf through stomata, while water vapour diffuses out of the leaf. The water vapour diffusion out of the leaves (transpiration) is introduced in <a href="landclimate.html"><span>Chapter&nbsp;7</span></a>.</figcaption>
</figure>
</div>
</div>
</div>
<!-- Photosynthetic CO~2~ assimilation leads to a continous depletion of CO~2~ inside the leaf. Therefore, $c_i$ reflects photosynthetic rates. This description of $A$ is specific for plants that follow the C~3~ photosynthetic pathway - the majority of plants and all trees. Grasses growing in warm climates predominantly follow the C~4~ photosynthetic pathway (see @sec-c4).  -->
<!-- Modelling photosynthesis is relatively complex because $g_s$ depends on $A$. @eq-photo-fick can therefore not be solved in a straight-forward manner. Furthermore, plants coordinate stomatal conductance to balance water losses and C assimilation but the exact relationship varies between species and depends on a multitude of mechanisms and traits related water transport in the plant (@sec-transpiration). Here, let's start by taking $g_s$ as given and look at how the assimilation rate $A$ depends on $c_i$. -->
<p>Once inside the leaf, CO<sub>2</sub> diffuses across mesophyll cells to the chloroplasts - the site of photosynthetic reactions. The conductance to this diffusion step - mesophyll conductance - is often ignored for modelling photosynthesis. Reflecting this, we are referring to “leaf-internal” CO<sub>2</sub> concentration, <span class="math inline">\(c_i\)</span>” here, instead of a more correct CO<sub>2</sub> concentration <em>at the chloroplast</em>.</p>
<p>Photosynthesis can be considered as a sequence of three processes that are serially connected - the three processes run one after the other and the rate of the slowest of the three processes determines the overall process rate of photosynthesis. The following is a condensed description, based on <span class="citation" data-cites="lambers08">Lambers, Chapin, and Pons (<a href="references.html#ref-lambers08" role="doc-biblioref">2008</a>)</span> and <span class="citation" data-cites="bonan">Bonan (<a href="references.html#ref-bonan" role="doc-biblioref">2015</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-photosynthesis" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/photosynthesis.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: Overview of photosynthesis, distinguishing the light reactions and the Calvin cycle. Image taken <a href="https://bookdown.org/jcog196013/BS2003/photosynthesis.html">https://bookdown.org/jcog196013/BS2003/photosynthesis.html</a>.</figcaption>
</figure>
</div>
</div>
</div>
<section id="light-absorption-at-the-cellular-level" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="light-absorption-at-the-cellular-level"><span class="header-section-number">4.3.1</span> Light absorption at the cellular level</h3>
<p>Light (photons) in the photosynthetically active wavelength spectrum (400-700 nm) is absorbed by <em>pigments</em> - mainly chlorophyll. The absorbed energy is transported in the form of excited chlorophyll to the reaction centers of photosystem I (PSI) and photosystem II (PSII). Relevant for photosynthesis is the number of photons in the photosynthetically active spectrum, not their total energy. That’s why <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a> is expressed in units of photons, not energy (Watts). (A photon in the blue wavelength has the same effect on CO<sub>2</sub> assimilation as a photon in the red wavelength, although it carries a higher energy). The excess energy is dissipated as heat or through other pathways.</p>
</section>
<section id="light-reactions" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="light-reactions"><span class="header-section-number">4.3.2</span> Light reactions</h3>
<p>In the reaction centers, the excitation energy of the chlorophyll is used for splitting electrons from water molecules, producing oxygen (O<sub>2</sub>) as a “side-product”. The electrons are transported along the electron transport chain and are used to produce NADPH and ATP. These are called the <em>light reactions</em> of photosynthesis. Up to here, radiation energy has been converted into chemical energy in the form of ATP. The production of ATP consumes inorganic phosphate.</p>
</section>
<section id="sec-calvin-cycle" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="sec-calvin-cycle"><span class="header-section-number">4.3.3</span> Calvin cycle</h3>
<p>NADPH and ATP are then used for reducing CO<sub>2</sub> (the energy-demanding reversal of oxidation) in the <em>Calvin cycle</em>. This step forms C<sub>3</sub> compounds (triose-phosphates) and occurs independently of light. It is therefore commonly referred to as the “dark reactions” of photosynthesis. Rubisco (ribulose-1,5-bisphosphate carboxylase/oxygenase) is the principal enzyme involved in the Calvin cycle and the amount of Rubisco determines the capacity for the carboxylation of RuBP (Ribulose-1,5-bisphosphate). Rubisco also catalyzes the oxygenation of RuBP which consumes O<sub>2</sub> and produces CO<sub>2</sub> as part of <em>photorespiration</em>. This respiration scales with photosynthetic activity and reduces the net photosynthetic CO<sub>2</sub> by 30-50%, depending on the relative concentrations of CO<sub>2</sub> and O<sub>2</sub>. At very low CO<sub>2</sub> levels, at around 30-50 ppm, the <em>photorespiratory compensation point</em> (<span class="math inline">\(\Gamma^\ast\)</span>) is reached and net photosynthesis is zero. In contrast to photorespiration, <em>dark respiration</em> (<span class="math inline">\(R_d\)</span>), which also produces CO<sub>2</sub>, arises from the decarboxylation of Rubisco and is independent of light, but proportional to the amount of Rubisco.</p>
<p>Reduced C in the form of sucrose or (after an additional step) starch is either consumed in the leaf during the night, or exported through the phloem and used for synthesising biomass or supplying plant-internal C storage as <em>non-structural C</em> (see <a href="ecosystemcarbon.html"><span>Chapter&nbsp;5</span></a>).</p>
</section>
<section id="summary" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.3.4</span> Summary</h3>
<p>The chemical summary equation of photosynthesis is: <span id="eq-photosynthesis-chemical"><span class="math display">\[
n\mathrm{CO}_2 + 2n\mathrm{H}_2\mathrm{O} \rightarrow (\mathrm{CH}_2\mathrm{O})_n + n\mathrm{O}_2 + n\mathrm{H}_2\mathrm{O}
\tag{4.6}\]</span></span> A total of eight photons is consumed to assimilate one molecule of CO<sub>2</sub>. For each molecule of CO<sub>2</sub>, one molecule of O<sub>2</sub> is produced. And for each molecule of CO<sub>2</sub>, one molecule of H<sub>2</sub>O is consumed (net). Note however, that this water consumption is not the primary reason for why plants use water. A much larger amount of water is consumed by the diffusion of water vapour from the water-saturated air inside the leaves out of the stomata. This <em>transpiration</em> flux is further explained in <a href="landclimate.html"><span>Chapter&nbsp;7</span></a>.</p>
</section>
<section id="sec-fvcb" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="sec-fvcb"><span class="header-section-number">4.3.5</span> Response to light and CO<sub>2</sub></h3>
<p>The three steps described above operate in series and each step is potentially rate-limiting and responds differently to the environment. The rates of the processes are coordinated such that they are roughly equal and co-limiting for average environmental conditions to which a leaf is exposed during a day. An imbalance of rates can lead to an excess production of electrons and can cause damage to the photosynthetic apparatus. This happens for example when leaves are exposed to very cold temperatures and high light during a frost event, or when you move your indoor plant that has been sitting in a dark corner for years suddenly into full sunlight outdoors.</p>
<p>The response of photosynthetic CO<sub>2</sub> assimilation (<span class="math inline">\(A\)</span>) to light (PPFD) and leaf-internal CO<sub>2</sub> (<span class="math inline">\(c_i\)</span>) reflects the serial nature of how the light and dark reactions are connected. <span class="math inline">\(A\)</span> saturates both in response to increasing PPFD as well as to increasing <span class="math inline">\(c_i\)</span>. When a leaf is exposed to increasing PPFD, <span class="math inline">\(A\)</span> initially increases and eventually saturates (<a href="#fig-photosynthesis_light">Figure&nbsp;<span>4.5</span></a>). The slope of the initial linear increase reflects the efficiency at which photons are used for CO<sub>2</sub> assimilation in the light reactions (the <em>quantum yield</em> <span class="math inline">\(\varphi_0\)</span>). Under these conditions, light, i.e.&nbsp;the rate of the light reactions, is limiting, not CO<sub>2</sub> inside the leaf. Under conditions of very high light, the dark reactions of the Calvin cycle become limiting. The assimilation rate attained under saturating light is commonly referred to as <span class="math inline">\(A_\mathrm{sat}\)</span>.</p>
<p>The level at which the light response of <span class="math inline">\(A\)</span> saturates (<span class="math inline">\(A_\mathrm{sat}\)</span>) varies <em>within</em> a species and across different plant species. Variations within species arise through the <em>acclimation</em> of the light reaction capacities to the typical light intensities to which a leaf is exposed. Acclimation of photosynthesis evolves over time scales of weeks to months. (Thus, your indoor plant suffers because the change to high-light conditions happened to fast.) <span class="math inline">\(A_\mathrm{sat}\)</span> also varies <em>across</em> species, reflecting the <em>adaptation</em> through evolution of different plant species to the environment in which they commonly grow. A typical light adaptation to different light levels is expressed by plants that commonly grow in the shady understorey versus plants that grow in the sun-exposed upper canopy.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-photosynthesis_light" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/assim_response_to_light_lambers08.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: Response of leaf photosynthesis to light and how it varies within species through acclimation to different growth environments (A) and across species through evolutionary adaptation (B). Figure from <span class="citation" data-cites="lambers08">Lambers, Chapin, and Pons (<a href="references.html#ref-lambers08" role="doc-biblioref">2008</a>)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>In a similar fashion, the response of <span class="math inline">\(A\)</span> to <span class="math inline">\(c_i\)</span> initially increase and saturates at high <span class="math inline">\(c_i\)</span>. This is reflected by the so-called “<em>A</em>-<em>c</em><sub>i</sub> curve” (<a href="#fig-a-ci-curve">Figure&nbsp;<span>4.6</span></a>). Commonly, net assimilation <span class="math inline">\(A_n = A - R_d\)</span> is considered when analysing <em>A</em>-<em>c</em><sub>i</sub> curves. <span class="math inline">\(A_n\)</span> is initially negative until the photorespiratory compensation point (<span class="math inline">\(\Gamma^\ast\)</span>) is reached. Then, <span class="math inline">\(A_n\)</span> increases steeply with <span class="math inline">\(c_i\)</span> as it is limited by the rate of RuBP carboxylation by Rubisco. This Rubisco carboxylation-limited functional response of assimilation is commonly denoted <span class="math inline">\(A_C\)</span>.</p>
<p>As <span class="math inline">\(c_i\)</span> increases further, <span class="math inline">\(A\)</span> is no longer limited by RuBP carboxylation, but by the rate at which RuBP becomes available. This, in turn, is governed by the rate at which ATP and NADPH are produced and thus by the rate of electron transport <span class="math inline">\(J\)</span>. This functional response of assimilation is commonly denoted <span class="math inline">\(A_J\)</span>. A limiting electron transport rate may be due to limiting light or a limiting capacity of electron transport (<span class="math inline">\(J_\mathrm{max}\)</span>). A slower further increase of <span class="math inline">\(A\)</span> with <span class="math inline">\(c_i\)</span> in the electron transport-limited range is due to the suppression of RuBP oxygenation at high concentrations of CO<sub>2</sub> (relative to O<sub>2</sub>). The effective assimilation rate across the full range of <span class="math inline">\(c_i\)</span> is the minimum of the electron transport-limited and the RuBP carboxylation-limited rate: <span id="eq-net-assimilation"><span class="math display">\[
A_n = \min(A_C, A_J) - R_d
\tag{4.7}\]</span></span></p>
<p>The <em>A</em>-<em>c</em><sub>i</sub> curve (<a href="#fig-a-ci-curve">Figure&nbsp;<span>4.6</span></a>) can be measured in the field and reveals the rates and efficiencies of the individual processes of the photosynthesis “chain” (light and dark reactions). These quantities are key for quantitatively describing and modeling leaf photosynthesis (see Box Farquhar-von Caemmerer-Berry model below).</p>
<!-- The acclimation and adaptation of $A_\mathrm{sat}$ (@fig-photosynthesis_light) reflects an acclimation and adaptation of the electron transport capacity and the capacity for RuBP carboxylation. Although acclimation can occur, it is not fast enough to respond to the strongly varying light conditions during a day. Therefore, plants have to tune the capacities of the different photosynthetic reactions such that they are mostly near the co-limitation point. -->
<div class="cell">
<div class="cell-output-display">
<div id="fig-a-ci-curve" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/a_ci_curve.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.6: The <em>A</em>-<em>c</em><sub>i</sub> curve. Net assimilation (<em>A</em><sub>n</sub> = <em>A</em> - <em>R</em><sub>d</sub>) is measured for different levels of leaf-internal CO<sub>2</sub> concentrations (black dots). The functional forms of <em>A</em><sub>C</sub> and <em>A</em><sub>J</sub> are fitted to the data points. The grey point indicates the co-limitation point. Figure from <span class="citation" data-cites="duursma15plosone">Duursma (<a href="references.html#ref-duursma15plosone" role="doc-biblioref">2015</a>)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Farquhar-von Caemmerer-Berry model
</div>
</div>
<div class="callout-body-container callout-body">
<p>Following the Farquhar-von Caemmerer-Berry (FvCB) model for C<sub>3</sub> photosynthesis <span class="citation" data-cites="farquhar80">(<a href="references.html#ref-farquhar80" role="doc-biblioref">Farquhar, Caemmerer, and Berry 1980</a>)</span>, the RuBP carboxylation-limited assimilation rate <span class="math inline">\(A_C\)</span> can be described as <span id="eq-ac"><span class="math display">\[
A_C = V_\mathrm{cmax} \frac{c_i - \Gamma^\ast}{c_i + K} \;,
\tag{4.8}\]</span></span> where <span class="math inline">\(K\)</span> is the effective Michaelis-Menten coefficient for <span class="math inline">\(A_C\)</span>, considering the balance of carboxylation and oxygenation by Rubisco. It depends on the partial pressure of oxygen (<span class="math inline">\(p\mathrm{O}_2\)</span>). <span class="math display">\[
K = K_c \left(1 + \frac{p\mathrm{O}_2}{K_o} \right)
\]</span> <span class="math inline">\(V_\mathrm{cmax}\)</span>, <span class="math inline">\(K_c\)</span>, <span class="math inline">\(K_o\)</span>, and <span class="math inline">\(\Gamma^\ast\)</span> all have a temperature dependency. In addition, <span class="math inline">\(\Gamma^\ast\)</span> is proportional to atmospheric pressure. These dependencies are shown in <a href="#sec-ftemp"><span>Section&nbsp;4.3.6</span></a> and are described in full detail in <span class="citation" data-cites="stocker20gmd">Stocker et al. (<a href="references.html#ref-stocker20gmd" role="doc-biblioref">2020</a>)</span>.</p>
<p>The electron transport-limited assimilation rate <span class="math inline">\(A_J\)</span> can be described as <span id="eq-aj"><span class="math display">\[
A_J = \frac{J}{4} \cdot \frac{c_i - \Gamma^\ast}{c_i + 2 \Gamma^\ast}\;.
\tag{4.9}\]</span></span> The electron transport rate <span class="math inline">\(J\)</span> is described by a saturating function that increases with absorbed light <span class="math inline">\(I_\mathrm{abs}\)</span> up to a maximum rate <span class="math inline">\(J_\mathrm{max}\)</span> <span id="eq-jmaxlim"><span class="math display">\[
J = \frac{4\varphi_0 I_\mathrm{abs}}{\sqrt{1+\left(\frac{4\varphi_0 I_\mathrm{abs}}{J_\mathrm{max}}\right)^2}}
\tag{4.10}\]</span></span></p>
<p>Together, <a href="#eq-ac">Equation&nbsp;<span>4.8</span></a> and <a href="#eq-aj">Equation&nbsp;<span>4.9</span></a> describe the combined effect of <span class="math inline">\(c_i\)</span>, (leaf) temperature, the absorbed photon flux density, and atmospheric pressure on leaf-level CO<sub>2</sub> assimilation.</p>
<p>With the mathematical description of <span class="math inline">\(A_C\)</span> and <span class="math inline">\(A_J\)</span> and their dependency on light and CO<sub>2</sub> following the FvCB model, <em>A-c</em><sub>i</sub> and the <em>A</em> vs.&nbsp;PPFD curves, as shown for measurements in <a href="#fig-photosynthesis_light">Figure&nbsp;<span>4.5</span></a> and <a href="#fig-a-ci-curve">Figure&nbsp;<span>4.6</span></a>, can thereby be modeled.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpmodel)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># modified seq() function to get a logarithmically spaced sequence</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>lseq <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">100000</span>, <span class="at">length.out=</span><span class="dv">6</span>) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(from), <span class="fu">log</span>(to), <span class="at">length.out =</span> length.out))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set model parameters (constants)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># see Stocker et al., 2020 GMD for a description</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">146</span>          <span class="co"># unit cost ratio a/b</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>c_cost <span class="ot">&lt;-</span> <span class="fl">0.41</span>       <span class="co"># marginal cost of Jmax</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.105</span>       <span class="co"># unit cost ratio c/b</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>kphio <span class="ot">&lt;-</span> <span class="fl">0.085</span>       <span class="co"># quantum yield efficiency</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>c_molmass <span class="ot">&lt;-</span> <span class="fl">12.0107</span> <span class="co"># molar mass, g / mol</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define environmental conditions</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="dv">15</span>             <span class="co"># temperature, deg C</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>ppfd <span class="ot">&lt;-</span> <span class="dv">500</span>          <span class="co"># micro-mol/m2/s</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>vpd  <span class="ot">&lt;-</span> <span class="dv">300</span>          <span class="co"># Pa</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>co2  <span class="ot">&lt;-</span> <span class="dv">400</span>          <span class="co"># ppm</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>elv  <span class="ot">&lt;-</span> <span class="dv">0</span>            <span class="co"># m.a.s.l.</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>fapar <span class="ot">&lt;-</span> <span class="dv">1</span>           <span class="co"># fraction</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>patm <span class="ot">&lt;-</span> <span class="dv">101325</span>       <span class="co"># Pa</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># get photosynthesis parameters gammastar, vcmax, jmax from p-model</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># this assumes vcmax and jmax to be optimally acclimated/adapted to</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># the specified environmental conditions and considers the temperature</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># and atmospheric-pressure dependence of all parameters.</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>out_pmodel <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>(</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">tc             =</span> tc,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">vpd            =</span> vpd,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">co2            =</span> co2,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">elv            =</span> elv,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">kphio          =</span> kphio,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta           =</span> beta,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">fapar          =</span> fapar,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppfd           =</span> ppfd,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_optci   =</span> <span class="st">"prentice14"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">"wang17"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># electron transport-limited assimilation rate as a function of CO2 partial pressure</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>calc_aj <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gammastar, kphio, ppfd, jmax){</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  kphio <span class="sc">*</span> ppfd <span class="sc">*</span> (ci <span class="sc">-</span> gammastar)<span class="sc">/</span>(ci <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> gammastar) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">+</span>((<span class="dv">4</span> <span class="sc">*</span> kphio <span class="sc">*</span> ppfd)<span class="sc">/</span>jmax)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co"># RuBP carboxylation-limited assimilation rate as a function of CO2 partial pressure</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>calc_ac <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gammastar, kmm, vcmax){</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  vcmax <span class="sc">*</span> (ci <span class="sc">-</span> gammastar)<span class="sc">/</span>(ci <span class="sc">+</span> kmm)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="co"># assimilation rate given stomatal conductance and leaf-internal </span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="co"># CO2 partial pressure</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>calc_a_gs <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gs, ca){</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  gs <span class="sc">*</span> (ca <span class="sc">-</span> ci)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="co"># conversion of CO2 concentration in ppm to partial pressure in Pa</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>co2_to_ca <span class="ot">&lt;-</span> <span class="cf">function</span>( co2, patm ){</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  ( <span class="fl">1.0e-6</span> ) <span class="sc">*</span> co2 <span class="sc">*</span> patm</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>df_ci <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ci_pa =</span> <span class="fu">co2_to_ca</span>(ci, <span class="at">patm =</span> patm)) <span class="sc">|&gt;</span> </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_j =</span> <span class="fu">calc_aj</span>(ci_pa, </span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>                       out_pmodel<span class="sc">$</span>gammastar, </span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kphio =</span> kphio, </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ppfd =</span> ppfd, </span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                       <span class="at">jmax =</span> out_pmodel<span class="sc">$</span>jmax)) <span class="sc">|&gt;</span> </span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_c =</span> <span class="fu">calc_ac</span>(ci_pa, </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                       out_pmodel<span class="sc">$</span>gammastar, </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                       out_pmodel<span class="sc">$</span>kmm, </span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vcmax =</span> out_pmodel<span class="sc">$</span>vcmax)) <span class="sc">|&gt;</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_act =</span> <span class="fu">min</span>(a_j, a_c)) <span class="sc">|&gt;</span> </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_gs =</span> <span class="fu">calc_a_gs</span>(ci_pa, </span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                          <span class="at">gs =</span> out_pmodel<span class="sc">$</span>gs, </span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ca =</span> out_pmodel<span class="sc">$</span>ca))</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>df_ci <span class="sc">|&gt;</span> </span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    a_j, </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    a_c</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a_gs</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"a_"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ci)) <span class="sc">+</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> a_, <span class="at">color =</span> Rate)) <span class="sc">+</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> a_act)) <span class="sc">+</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">00</span>, <span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(-20, 80) +</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> (out_pmodel<span class="sc">$</span>gammastar<span class="sc">/</span>(<span class="fl">1.0e-6</span> <span class="sc">*</span> patm)), <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"c"</span>)[i], <span class="st">" (ppm)"</span>)), </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>), <span class="st">" ("</span>, mu, <span class="st">"mol m"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>},<span class="st">" s"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>      <span class="co"># "a_gs",</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>      <span class="st">"a_j"</span>,</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>      <span class="st">"a_c"</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>      <span class="co"># expression(paste(italic("A")[gs])),</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[J])),</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[C]))</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>( </span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>      <span class="co"># "#009E73", </span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#56B4E9"</span>, </span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#E69F00"</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-a-ci-curve-rpmodel" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gpp_files/figure-html/fig-a-ci-curve-rpmodel-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.7: The <em>A</em>-<em>c</em><sub>i</sub> curve as simulated by the FvCB model. <em>A</em><sub>gs</sub> is shown here as the dependency of <em>A</em> on stomatal conductance following <a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a> for a given <em>g</em><sub>s</sub>. The fact that <em>A</em><sub>C</sub>, <em>A</em><sub>J</sub>, and <em>A</em><sub>gs</sub> intersect in one point does not follow from the FvCB model, but is simulated here based on a model of eco-evolutionary optimality (<em>P-model</em> <span class="citation" data-cites="stocker20gmd">Stocker et al. (<a href="references.html#ref-stocker20gmd" role="doc-biblioref">2020</a>)</span>, implemented by the {rpmodel} R package) which predicts that photosynthetic capacities are acclimated such that a leaf operates close to the intersection point of <em>A</em><sub>C</sub> and and <em>A</em><sub>J</sub>. The point at which curves intersect with the x-axis (y = 0) is the photorespiratory compensation point. The environmental conditions used as forcing for the simulation displayed here can be seen by unfolding <em>code</em>.</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-a-ppfd-curve-rpmodel">Figure&nbsp;<span>4.8</span></a> shows the light response curve of <span class="math inline">\(A_J - R_d\)</span> following the FvCB model. The response is shown for leaves acclimated to different levels of light, thus having different values for <span class="math inline">\(J_\mathrm{max}\)</span>. Because acclimation to light also involves a change in the Rubisco content of leaves and thus <span class="math inline">\(V_\mathrm{cmax}\)</span>, “high-light leaves” also have higher dark respiration rates. Therefore, under low light conditions, leaves acclimated to low light have higher net assimilation rates than leaves acclimated to high light. This is illustrated by <a href="#fig-a-ppfd-curve-rpmodel">Figure&nbsp;<span>4.8</span></a> <strong>a</strong>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpmodel)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># modified seq() function to get a logarithmically spaced sequence</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>lseq <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">100000</span>, <span class="at">length.out=</span><span class="dv">6</span>) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(from), <span class="fu">log</span>(to), <span class="at">length.out =</span> length.out))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set model parameters (constants)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># see Stocker et al., 2020 GMD for a description</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">146</span>          <span class="co"># unit cost ratio a/b</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>c_cost <span class="ot">&lt;-</span> <span class="fl">0.41</span>       <span class="co"># marginal cost of Jmax</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.105</span>       <span class="co"># unit cost ratio c/b</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>kphio <span class="ot">&lt;-</span> <span class="fl">0.085</span>       <span class="co"># quantum yield efficiency</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>c_molmass <span class="ot">&lt;-</span> <span class="fl">12.0107</span> <span class="co"># molar mass, g / mol</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define environmental conditions</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span> <span class="dv">15</span>             <span class="co"># temperature, deg C</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>ppfd <span class="ot">&lt;-</span> <span class="dv">500</span>          <span class="co"># micro-mol/m2/s</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>vpd  <span class="ot">&lt;-</span> <span class="dv">300</span>          <span class="co"># Pa</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>co2  <span class="ot">&lt;-</span> <span class="dv">400</span>          <span class="co"># ppm</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>elv  <span class="ot">&lt;-</span> <span class="dv">0</span>            <span class="co"># m.a.s.l.</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>fapar <span class="ot">&lt;-</span> <span class="dv">1</span>           <span class="co"># fraction</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>patm <span class="ot">&lt;-</span> <span class="dv">101325</span>       <span class="co"># Pa</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># get photosynthesis parameters gammastar, vcmax, jmax from p-model</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># this assumes vcmax and jmax to be optimally acclimated/adapted to</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># the specified environmental conditions and considers the temperature</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="co"># and atmospheric-pressure dependence of all parameters.</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># first for low light</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>out_pmodel_lo <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">tc             =</span> tc,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">vpd            =</span> vpd,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">co2            =</span> co2,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">elv            =</span> elv,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">kphio          =</span> kphio,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta           =</span> beta,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">fapar          =</span> fapar,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppfd           =</span> ppfd<span class="sc">*</span><span class="fl">0.5</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_optci   =</span> <span class="st">"prentice14"</span>,</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">"wang17"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co"># medium light</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>out_pmodel_me <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>(</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">tc             =</span> tc,</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">vpd            =</span> vpd,</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">co2            =</span> co2,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">elv            =</span> elv,</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">kphio          =</span> kphio,</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta           =</span> beta,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">fapar          =</span> fapar,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppfd           =</span> ppfd,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_optci   =</span> <span class="st">"prentice14"</span>,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">"wang17"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="co"># high light</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>out_pmodel_hi <span class="ot">&lt;-</span> <span class="fu">rpmodel</span>(</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">tc             =</span> tc,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">vpd            =</span> vpd,</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">co2            =</span> co2,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">elv            =</span> elv,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">kphio          =</span> kphio,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta           =</span> beta,</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">fapar          =</span> fapar,</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppfd           =</span> ppfd<span class="sc">*</span><span class="dv">2</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_optci   =</span> <span class="st">"prentice14"</span>,</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">method_jmaxlim =</span> <span class="st">"wang17"</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">do_ftemp_kphio =</span> <span class="cn">FALSE</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="co"># electron transport-limited assimilation rate as a function of CO2 partial pressure</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>calc_aj <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gammastar, kphio, ppfd, jmax){</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  kphio <span class="sc">*</span> ppfd <span class="sc">*</span> (ci <span class="sc">-</span> gammastar)<span class="sc">/</span>(ci <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> gammastar) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">+</span>((<span class="dv">4</span> <span class="sc">*</span> kphio <span class="sc">*</span> ppfd)<span class="sc">/</span>jmax)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="co"># RuBP carboxylation-limited assimilation rate as a function of CO2 partial pressure</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>calc_ac <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gammastar, kmm, vcmax){</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  vcmax <span class="sc">*</span> (ci <span class="sc">-</span> gammastar)<span class="sc">/</span>(ci <span class="sc">+</span> kmm)</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="co"># assimilation rate given stomatal conductance and leaf-internal </span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co"># CO2 partial pressure</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>calc_a_gs <span class="ot">&lt;-</span> <span class="cf">function</span>(ci, gs, ca){</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>  gs <span class="sc">*</span> (ca <span class="sc">-</span> ci)</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="co"># conversion of CO2 concentration in ppm to partial pressure in Pa</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>co2_to_ca <span class="ot">&lt;-</span> <span class="cf">function</span>( co2, patm ){</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>  ( <span class="fl">1.0e-6</span> ) <span class="sc">*</span> co2 <span class="sc">*</span> patm</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>df_ppfd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppfd =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2000</span>, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_j_lo =</span> <span class="fu">calc_aj</span>(<span class="fu">co2_to_ca</span>(<span class="dv">400</span>, <span class="at">patm =</span> patm), </span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                          out_pmodel_lo<span class="sc">$</span>gammastar, </span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kphio =</span> kphio, </span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ppfd =</span> ppfd, </span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                          <span class="at">jmax =</span> out_pmodel_lo<span class="sc">$</span>jmax <span class="sc">*</span> <span class="fl">0.5</span>) <span class="sc">-</span> </span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>           out_pmodel_lo<span class="sc">$</span>rd) <span class="sc">|&gt;</span> </span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_j_me =</span> <span class="fu">calc_aj</span>(<span class="fu">co2_to_ca</span>(<span class="dv">400</span>, <span class="at">patm =</span> patm), </span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                       out_pmodel_me<span class="sc">$</span>gammastar, </span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kphio =</span> kphio, </span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ppfd =</span> ppfd, </span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                       <span class="at">jmax =</span> out_pmodel_me<span class="sc">$</span>jmax) <span class="sc">-</span> </span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>           out_pmodel_me<span class="sc">$</span>rd) <span class="sc">|&gt;</span> </span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_j_hi =</span> <span class="fu">calc_aj</span>(<span class="fu">co2_to_ca</span>(<span class="dv">400</span>, <span class="at">patm =</span> patm), </span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                          out_pmodel_hi<span class="sc">$</span>gammastar, </span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kphio =</span> kphio, </span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ppfd =</span> ppfd, </span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>                          <span class="at">jmax =</span> out_pmodel_hi<span class="sc">$</span>jmax <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>           out_pmodel_hi<span class="sc">$</span>rd)</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> df_ppfd <span class="sc">|&gt;</span> </span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(a_j_lo, a_j_me, a_j_hi), </span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"a_"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ppfd)) <span class="sc">+</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> a_, <span class="at">color =</span> Rate)) <span class="sc">+</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"PPFD ("</span>, mu, <span class="st">"mol m"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}, <span class="st">"s"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>)), </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[J] <span class="sc">-</span> <span class="fu">italic</span>(R)[d], <span class="st">" ("</span>, mu, <span class="st">"mol m"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>},<span class="st">" s"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"a_j_lo"</span>,</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_j_me"</span>,</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_j_hi"</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Low light"</span>)),</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Medium light"</span>)),</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"High light"</span>))),</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>( <span class="st">"#009E73"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>)) <span class="sc">+</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> gg <span class="sc">+</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">20</span>)</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> gg <span class="sc">+</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">2000</span>)</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(gg1, gg2, </span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-a-ppfd-curve-rpmodel" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gpp_files/figure-html/fig-a-ppfd-curve-rpmodel-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.8: The light response curve of the electron transport-limited net assimilation rate <em>A</em><sub>J</sub> - <em>R</em><sub>d</sub> as simulated by the FvCB model using simulated acclimated <em>J</em><sub>max</sub> values for different light levels from the P-model (implemented by the {rpmodel} R package) . The environmental conditions used as forcing for the simulation displayed here can be seen by unfolding <em>code</em>.</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that the FvCB model, on its own, does not allow us to model the LUE term in <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>. An important additional ingredient is the stomatal conductance (<span class="math inline">\(g_s\)</span>) which is relevant for determining the ratio of ambient to leaf-internal CO<sub>2</sub> concentrations. It is described in <a href="#sec-transpiration"><span>Section&nbsp;4.4</span></a>.</p>
</div>
</div>
</section>
<section id="sec-ftemp" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="sec-ftemp"><span class="header-section-number">4.3.6</span> Response to temperature</h3>
<p>All processes involved in photosynthesis are strongly affected by temperature. Enzymatic rates, like Rubisco carboxylation, have a temperature at which reaction rates have a maximum. As a consequence, assimilation rates also attain a maximum at a certain temperature - the <em>temperature optimum</em> (<em>T</em><sub>opt</sub>). In contrast, dark respiration (<span class="math inline">\(R_d\)</span>) monotonically increases with temperature. That is, it continues to rise as temperatures go up - without attaining a maximum. As a consequence, the decline of net assimilation rates is even faster at towards high temperatures than that of gross assimilation rates.</p>
<p>The temperature dependency of leaf CO<sub>2</sub> assimilation rates can be measured in the field by exposing a leaf to a range of temperatures (within a relatively short period of time) and measuring assimilation rates for each temperature. When looking at such measurements, a temperature optimum of net photosynthesis is evident.</p>
<p>The Farquhar-von Caemmerer Berry model for C<sub>3</sub> photosynthesis (see Box ‘Farquhar von Caemmerer Berry model’) and the mathematical description of temperature dependencies of factors therein (<span class="math inline">\(V_\mathrm{cmax}\)</span>, <span class="math inline">\(J_\mathrm{max}\)</span>, <span class="math inline">\(K_c\)</span>, <span class="math inline">\(K_o\)</span>, and <span class="math inline">\(\Gamma^\ast\)</span>, temperature dependencies not shown here) provide a basis for modelling the temperature dependency of assimilation rates. Such modelled temperature dependencies are shown in <a href="#fig-temp_dep">Figure&nbsp;<span>4.9</span></a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">temp =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gammastar =</span> <span class="fu">gammastar</span>(temp, <span class="at">patm =</span> <span class="dv">101325</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">kmm =</span> <span class="fu">kmm</span>(temp, <span class="at">patm =</span> <span class="dv">101325</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">vcmax =</span> out_pmodel<span class="sc">$</span>vcmax25 <span class="sc">*</span> <span class="fu">ftemp_inst_vcmax</span>(temp, <span class="at">tcgrowth =</span> <span class="dv">15</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">jmax =</span> <span class="fl">1.7</span> <span class="sc">*</span> out_pmodel<span class="sc">$</span>vcmax25 <span class="sc">*</span> <span class="fu">ftemp_inst_jmax</span>(temp, <span class="at">tcgrowth =</span> <span class="dv">15</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">rd =</span> <span class="fl">0.05</span> <span class="sc">*</span> out_pmodel<span class="sc">$</span>vcmax25 <span class="sc">*</span> <span class="fu">ftemp_inst_rd</span>(temp)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_j =</span> <span class="fu">calc_aj</span>(<span class="at">ci =</span> <span class="fl">28.14209</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                       gammastar, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">kphio =</span> kphio, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ppfd =</span> ppfd, </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">jmax =</span> jmax)) <span class="sc">|&gt;</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_c =</span> <span class="fu">calc_ac</span>(<span class="at">ci =</span> <span class="fl">28.14209</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                       gammastar, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                       kmm, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vcmax =</span> vcmax)) <span class="sc">|&gt;</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_cr =</span> a_c <span class="sc">-</span> rd, </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">a_jr =</span> a_j <span class="sc">-</span> rd) <span class="sc">|&gt;</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">assim =</span> <span class="fu">min</span>(a_jr, a_cr))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> df_temp <span class="sc">|&gt;</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(gammastar, kmm), </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp)) <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> Rate)) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temperature (°C)"</span>)), </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Value (Pa)"</span>))) <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  khroma<span class="sc">::</span><span class="fu">scale_color_okabeito</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"gammastar"</span>, </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>               <span class="st">"kmm"</span>),</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(Gamma)<span class="sc">^</span><span class="st">"*"</span>)), </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">italic</span>(K)))</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> df_temp <span class="sc">|&gt;</span> </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(vcmax, jmax, rd), </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp)) <span class="sc">+</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> Rate)) <span class="sc">+</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temperature (°C)"</span>)), </span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Rate ("</span>, mu, <span class="st">"mol m"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>},<span class="st">" s"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>))) <span class="sc">+</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  khroma<span class="sc">::</span><span class="fu">scale_color_okabeito</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"vcmax"</span>, </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>               <span class="st">"jmax"</span>, </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>               <span class="st">"rd"</span>),</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"V"</span>)[cmax])), </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"J"</span>)[max])), </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"R"</span>)[d])))</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>df_net_plot <span class="ot">&lt;-</span> df_temp <span class="sc">|&gt;</span> </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a_cr =</span> a_c <span class="sc">-</span> rd,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">a_jr =</span> a_j <span class="sc">-</span> rd) <span class="sc">|&gt;</span> </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(rd, a_cr, a_jr, assim), </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>df_gross_plot <span class="ot">&lt;-</span> df_temp <span class="sc">|&gt;</span> </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(a_c, a_j), </span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Rate"</span>, </span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>gg3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> value, <span class="at">color =</span> Rate),</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df_gross_plot,</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> value, <span class="at">color =</span> Rate),</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df_net_plot) <span class="sc">+</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"rd"</span>,</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_c"</span>,</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_j"</span>,</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_cr"</span>,</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>               <span class="st">"a_jr"</span>,</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>               <span class="st">"assim"</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"R"</span>)[d])),</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[C])),</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[J])),</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[C] <span class="sc">~</span> <span class="sc">-</span> <span class="er">~</span> <span class="fu">italic</span>(<span class="st">"R"</span>)[d])),</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[J] <span class="sc">~</span> <span class="sc">-</span> <span class="er">~</span> <span class="fu">italic</span>(<span class="st">"R"</span>)[d])),</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>)[n]))),</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#CC79A7"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"black"</span>)</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Temperature (°C)"</span>)), </span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"A"</span>), <span class="st">"("</span>, mu, <span class="st">"mol m"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>},<span class="st">" s"</span> <span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>)),</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Rate"</span>,</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Rate"</span>) <span class="sc">+</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(gg1, gg2, gg3, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-temp_dep" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gpp_files/figure-html/fig-temp_dep-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.9: Temperature dependencies of quantities in the FvCB model. The dashed lines in the bottom panel are the gross assimilation rates <em>A</em><sub>C</sub> and <em>A</em><sub>J</sub>.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="adptation-and-acclimation-of-topt" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="adptation-and-acclimation-of-topt"><span class="header-section-number">4.3.7</span> Adptation and acclimation of <em>T</em><sub>opt</sub></h3>
<p>The temperature dependencies shown in <a href="#fig-temp_dep">Figure&nbsp;<span>4.9</span></a> are <em>instantaneous</em> responses. That is, they represent the responses to changes in temperature that evolve over short time scales - minutes to hours. Over longer time scales, the shapes of the instantaneous temperature responses change. The temperature optimum of photosynthesis (<em>T</em><sub>opt</sub>) tends to be higher for plant species that grow in warm climates than for plants that can be found in cold climates (<a href="#fig-topt-kumarathunge">Figure&nbsp;<span>4.10</span></a> a). Such variations of <em>T</em><sub>opt</sub> across different plant species reflects species’ <em>adaptation</em> to their growth environment which makes them perform well and compete effectively under certain environmental conditions and is related to their genes and is thus passed on from generation to generation. <em>T</em><sub>opt</sub> can be considered as a plant trait (see <a href="biogeography.html#sec-traits"><span>Section&nbsp;2.4</span></a>).</p>
<p><em>T</em><sub>opt</sub> not only varies between species growing in different climates, but can also vary <em>within</em> a given species and even within a given plant when it is exposed to different temperatures for a longer period <span class="citation" data-cites="kumarathunge19newphyt">(<a href="references.html#ref-kumarathunge19newphyt" role="doc-biblioref">Kumarathunge et al. 2019</a>)</span>. Given enough time, the instantaneous temperature response and <em>T</em><sub>opt</sub> will shift to higher temperatures as a result of persistent exposure to warmer temperatures. Such variations in a plant trait (here <em>T</em><sub>opt</sub>) within species and an individual plant is referred to as <em>acclimation</em>. <a href="#fig-topt-kumarathunge">Figure&nbsp;<span>4.10</span></a> b shows how <em>T</em><sub>opt</sub> varies within different species (distinguished by color) over the course of the seasons - a demonstration of acclimation.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-topt-kumarathunge" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/topt-kumarathunge.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.10: Temperature optimum of leaf net photosynthesis at an intercellular CO<sub>2</sub> concentration of 275 micro-mol mol<sup>-1</sup> (T<sub>optA275</sub>) of mature plants growing in their native environments (d), species in the field (grown at ambient growth temperatures) measured in at least two or more seasons (e). T<sub>growth</sub> is the mean air temperature of the preceding 30 d.&nbsp;Different colours depict plant functional types: orange, tropical evergreen angiosperms (EA-Tr); light blue, arctic tundra; red, temperate deciduous angiosperms (DA-Te); blue, temperate evergreen angiosperms (EA-Te); green, boreal evergreen gymnosperms (EG-Br); purple, temperate evergreen gymnosperms (EG-Te); those in (b,c,e,f) depict different datasets. The thick black lines are: (in d) least-squares linear regression fits and linear mixed-effect model fits (in e) with random intercepts for each dataset. Error bars represent +/-1 standard error. Figure and caption text from <span class="citation" data-cites="kumarathunge19newphyt">Kumarathunge et al. (<a href="references.html#ref-kumarathunge19newphyt" role="doc-biblioref">2019</a>)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>Acclimation is relatively common to observe also for other physiological traits than <em>T</em><sub>opt</sub>. For example, photosynthetic capacities (the maximum rate of Rubisco carboxylation - <span class="math inline">\(V_\mathrm{cmax}\)</span> in the FvCB model - or the maximum rate of electron transport - <span class="math inline">\(J_\mathrm{max}\)</span>) acclimate over the course of seasons <span class="citation" data-cites="jiang20gcb">(<a href="references.html#ref-jiang20gcb" role="doc-biblioref">Jiang et al. 2020</a>)</span>. Other plant traits are less plastic or not plastic at all. For example phenological strategies (e.g., deciduousness) does not acclimate. The acclimation of physiological traits is important for understanding vegetation and land carbon cycle responses to long-term trends in climate. While it may be exected that plants have a certain capacity for acclimation to a new climate, limits to acclimation must be better understood.</p>
<!-- XXX LES 2: Add box explaining acclimated vs. instantaneous response (Way & Yamori, 2014) -->
</section>
<section id="sec-c4" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="sec-c4"><span class="header-section-number">4.3.8</span> C<sub>4</sub> photosynthesis</h3>
<p>Coming soon.</p>
</section>
</section>
<section id="sec-transpiration" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-transpiration"><span class="header-section-number">4.4</span> Transpiration and leaf water-carbon coupling</h2>
<p>The opening of stomata is highly sensitive to environmental factors and the CO<sub>2</sub> assimilation rate feeds back to stomatal opening. By opening and closing stomata, plants regulate the conductance to CO<sub>2</sub> diffusion from the ambient air into the leaves and to the photosynthesis reaction sites. Simultaneously, when stomata are open, water vapour diffuses out of the leaf - <em>transpiration</em>. This link between CO<sub>2</sub> and water loss is at the core of stomatal regulation to balance C uptake and desiccation.</p>
<p>The diffusive supply of CO<sub>2</sub> to the photosynthetic reaction sites is determined by a series of conductances. The description of the diffusive CO<sub>2</sub> uptake in <a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a> resolves this as a single conductance. However, stomatal conductance is only one chain in this series. More realistically, the leaf boundary layer conductance and the mesophyll conductance are treated separately from the stomatal conductance. However, because the leaf boundary layer conductance is much larger than the stomatal conductance, it is not limiting. Furthermore, actively regulated plant physiological responses to the environment arise through the stomatal conductance <span class="math inline">\(g_s\)</span>. As described in <a href="#sec-photosynthesis"><span>Section&nbsp;4.3</span></a>, mesophyll conductance is often ignored due to practical limitations for separating it from stomatal conductance in measurements and due to very poorly known dependencies to the environment. Hence, we focus on <span class="math inline">\(g_s\)</span> here and describe the diffusive CO<sub>2</sub> supply to photosynthesis by <a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a>.</p>
<p>The diffusive water vapour flux out of the leaf - transpiration - is driven by the difference of water vapour pressure in the leaf-interior air spaces (<span class="math inline">\(e_i\)</span>) and the the water vapour pressure at the leaf surface (<span class="math inline">\(e_s\)</span>). Their difference is commonly referred to as the <em>vapour pressure deficit</em> (VPD), here denoted as <span class="math inline">\(D = e_s - e_i\)</span>. Leaf-interior air spaces are water vapour-saturated, while the surrounding air is not. Fick’s law predicts that a diffusive flux occurs in presence of a concentration difference, hence transpiration can be described as <span id="eq-transpiration"><span class="math display">\[
E = 1.6 \; g_s \; D
\tag{4.11}\]</span></span> The factor 1.6 arises due to the lower diffusivity of CO<sub>2</sub> compared with H<sub>2</sub>O. Hence, <span class="math inline">\(g_s\)</span> has to be understood as a conductance to CO<sub>2</sub> diffusion (mol CO<sub>2</sub> m<sup>-2</sup> s<sup>-1</sup>). Note that <span class="math inline">\(g_s\)</span> regulates both transpiration (<a href="#eq-transpiration">Equation&nbsp;<span>4.11</span></a>) and assimilation (<a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a>) at the leaf-level. A tight coupling between water and carbon fluxes at the leaf-level follows from the physical principle of diffusion.</p>
<p>Water loss through transpiration poses risks and incurs costs for a plant. The diffusive water vapour flux through stomata has to be maintained by root water uptake from the soil and transport along the xylem in the plant. When the water content in the rooting zone declines, it becomes increasingly hard for plants to extract water from the soil - they have to “suck” out the water with a increasingly negative water potential - a negative pressure. The hydraulic relationships of water transport along the soil-plant-atmosphere continuum will be introduced later. What matters here is that such negative water potentials along the water transport pathway are dangerous for the plant and can lead to lethal desiccation of cells, leaves, branches, or entire plants.</p>
<p>Avoidance of dangerous desiccation is enabled by responses at the level of leaves and the plant which operate at a range of time scales. At time scales of seconds to minutes and at the level of a leaf, stomatal conductance is reduced in response to dry air and dry soil conditions. At time scales of weeks to months, or even years, the the leaf area of a plant may decline under dry conditions. At even longer time scales (albeit this time scale is subject to large unknowns and active research), plants are genetically adapted (or may acclimate within their lifetime) to dry conditions by resistant water transport (resistant xylem) and effective water uptake organs (deeper roots).</p>
<p>Obviously, such adaptations and the largely instantaneous stomatal response incurs a cost - the opportunity cost of reduced CO<sub>2</sub> assimilation when stomatal conductance is reduced and the construction cost of building water-stress adapted organs. Hence, plants always have to balance carbon uptake and water loss and a tight <em>carbon-water coupling</em> at the level of plants, and ecosystems arises from these leaf-level processes.</p>
<section id="sec-wue" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="sec-wue"><span class="header-section-number">4.4.1</span> Water use efficiency</h3>
<p>The trade-off between transpiration and assimilation can be measured by considering their ratio by combining <a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a> and <a href="#eq-transpiration">Equation&nbsp;<span>4.11</span></a> to define the <em>instantaneous water-use efficiency</em>: <span id="eq-wue-instantaneous"><span class="math display">\[
\frac{A_n}{E} = \frac{c_a(1 - \chi)}{1.6\;D}\;,
\tag{4.12}\]</span></span> where <span class="math inline">\(\chi = c_i/c_a\)</span>. The instantaneous water-use efficiency is proportional to <span class="math inline">\(D^{-1}\)</span>. In other words, the drier the air, the more transpiration per unit net CO<sub>2</sub> assimilation a leaf “suffers”. This demonstrates the strong effect of atmospheric dryness on the water-carbon trade-off. To remove the effect of vapour pressure deficit (<span class="math inline">\(D\)</span>) on transpiration and focus on the biological component of the water-carbon trade-off, the <em>intrinsic water-use efficiency</em> (iWUE) is defined by relating net assimilation to stomatal conductance: <span id="eq-wue-intrinsic"><span class="math display">\[
\frac{A_n}{g_s} = \frac{c_a}{1.6}(1 - \chi)
\tag{4.13}\]</span></span> Note that <a href="#eq-wue-instantaneous">Equation&nbsp;<span>4.12</span></a> and <a href="#eq-wue-intrinsic">Equation&nbsp;<span>4.13</span></a> are written as being proportional to <span class="math inline">\(c_a(1-\chi)\)</span>. Of course, this term is mathematically equivalent to <span class="math inline">\((c_a - c_i)\)</span>. However, there is a reason for expressing it this way. First, it reflects the direct influence of <span class="math inline">\(c_a\)</span> ambient (atmospheric) CO<sub>2</sub> concentration on the water-carbon trade-off - less water is lost for a given amount of C assimilation under elevated CO<sub>2</sub>. Second, observations suggest that <span class="math inline">\(\chi\)</span> is regulated by plants to remain relatively constant under a wide range of CO<sub>2</sub> levels <span class="citation" data-cites="ainsworth05">(<a href="references.html#ref-ainsworth05" role="doc-biblioref">Ainsworth and Long 2005</a>)</span> and <a href="#fig-constant-chi">Figure&nbsp;<span>4.11</span></a>. The near constancy of <span class="math inline">\(\chi\)</span> is also reflected by the observation that <span class="math inline">\(A_n\)</span> and <span class="math inline">\(g_s\)</span> vary in near proportion across a wide range of light levels <span class="citation" data-cites="bonan">(<a href="references.html#ref-bonan" role="doc-biblioref">Bonan 2015</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-constant-chi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/constant_chi.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.11: Constancy of leaf-internal to ambient CO<sub>2</sub>. (a) Relationship between net photosynthesis (<em>A</em><sub>n</sub>) and stomatal conductance (<em>g</em><sub>s</sub>) of one species (Jack pine) over a range of light conditions. A linear relationship is reflective of a constant <em>c</em><sub>i</sub>:<em>c</em><sub>a</sub>. Figure from <span class="citation" data-cites="bonan">Bonan (<a href="references.html#ref-bonan" role="doc-biblioref">2015</a>)</span>. (b) Response of multiple photosynthesis-related variables to elevated CO<sub>2</sub> from free-air carbon dioxide enrichment experiments. Figure from <span class="citation" data-cites="ainsworth05">Ainsworth and Long (<a href="references.html#ref-ainsworth05" role="doc-biblioref">2005</a>)</span>. <em>c</em><sub>i</sub>:<em>c</em><sub>a</sub></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-carbon-isotopes" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="sec-carbon-isotopes"><span class="header-section-number">4.4.2</span> Isotopic fractionation</h3>
<p>Coming soon.</p>
</section>
<section id="sec-stomatalregulation" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="sec-stomatalregulation"><span class="header-section-number">4.4.3</span> Stomatal regulation</h3>
<p>The closing of stomates and the reduction of stomatal conductance <span class="math inline">\(g_s\)</span> under dry conditions prevents plants from dangerous desiccation. However, a reduced <span class="math inline">\(g_s\)</span> also leads to a reduction in CO<sub>2</sub> diffusion into leaves and thus a reduction of photosynthetic CO<sub>2</sub> assimilation. Hence, plants have to balance a trade-off between carbon gain and the risk of desiccation. A complete stomatal closure under moderately dry conditions (low soil moisture, high VPD) may be safe in terms of desiccation avoidance but comes at an excessive cost in terms of foregone CO<sub>2</sub> uptake (and similarly vice-versa). An optimal strategy must lie somewhere in between these extreme strategies.</p>
<p>Observations of leaf and ecosystem fluxes CO<sub>2</sub> and water vapour fluxes document how stomatal conductance responds to increasing VPD and decreasing soil moisture. <a href="#fig-novick16">Figure&nbsp;<span>4.12</span></a> shows this for measurements taken at the ecosystem-level, quantifying the canopy stomatal conductance (denoted by an uppercase <span class="math inline">\(G_s\)</span>), representative for the collective behaviour of all leaves in the canopy. Three important aspects of this relationship stand out. First, <span class="math inline">\(G_s\)</span> declines in response to VPD in a non-linear fashion (high sensitivity to VPD at low VPD, lower sensitivity towards higher VPD). Second, there is an interaction between the effect of VPD and soil moisture. Under conditions of dry soils, <span class="math inline">\(G_s\)</span> is reduced compared to wet soils, given the same VPD. Third, at the most moist site (<a href="#fig-novick16">Figure&nbsp;<span>4.12</span></a> a), <span class="math inline">\(G_s\)</span> under moist conditions (moist soils, low VPD) is highest but declines most rapidly with VPD.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-novick16" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/fig-novick16.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.12: Response of canopy conductance (ecosystem-level aggregate stomatal conductance) to soil and air drying at four different sites (a-d) that differ in average aridity. Soil moisture levels are represented by colors of circles. DI in each panel’s title is the site’s dryness index calculated as the ratio of potential evapotranspiration over precipitation. Figure from <span class="citation" data-cites="novick16natcc">Novick et al. (<a href="references.html#ref-novick16natcc" role="doc-biblioref">2016</a>)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>A simple empirical model for the <span class="math inline">\(G_s\)</span> response to VPD <span class="citation" data-cites="oren01">(<a href="references.html#ref-oren01" role="doc-biblioref">Oren et al. 2001</a>)</span> is given by <span class="math display">\[
G_s = G_{s,\mathrm{ref}} \left(1 - m \ln D \right)\;.
\]</span> Here, <span class="math inline">\(G_{s,\mathrm{ref}}\)</span> is a reference canopy conductance, <span class="math inline">\(D\)</span> is VPD, and <span class="math inline">\(m\)</span> is a stomatal sensitivity parameter. The data shown in <a href="#fig-novick16">Figure&nbsp;<span>4.12</span></a> indicate that the sensitivity parameter <span class="math inline">\(m\)</span> is not a constant, but decreases with drying soils and tends to be lower at dry sites than at moist sites investigated by <span class="citation" data-cites="novick16natcc">Novick et al. (<a href="references.html#ref-novick16natcc" role="doc-biblioref">2016</a>)</span>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stomatal optimization models
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The aspect that plants regulate stomatal conductance to balance the trade-off between carbon gain and water loss lends itself to modelling the stomatal response considering <em>optimality principles</em>. Indeed, there is empirical evidence that optimality models are a good representation of how stomata are regulated. Following this notion, it can be assumed that stomatal conductance is optimised such that the net between the carbon gain by increasing stomatal conductance and the carbon cost by the resulting increased transpiration and is maximized.</p>
<p><span id="eq-optim-max"><span class="math display">\[
A - aE - bV_\mathrm{cmax} = \arg \max
\tag{4.14}\]</span></span></p>
<p>Over time scales of days to weeks, <span class="math inline">\(V_\mathrm{cmax}\)</span> in the FvCB model (see box above) is coordinated with stomatal conductance <span class="citation" data-cites="joshi22natplants">(<a href="references.html#ref-joshi22natplants" role="doc-biblioref">Joshi et al. 2022</a>)</span>. The simultaneous effects of <span class="math inline">\(V_\mathrm{cmax}\)</span> and <span class="math inline">\(g_s\)</span> are reflected by <span class="math inline">\(\chi\)</span>. Therefore, <a href="#eq-optim-max">Equation&nbsp;<span>4.14</span></a> can be expressed with respect to optimising <span class="math inline">\(\chi\)</span>. Maximising a function is equivalent to finding the point where its first derivative (here with respect to <span class="math inline">\(\chi\)</span>) is zero. <span class="citation" data-cites="prentice14ecollett">(<a href="references.html#ref-prentice14ecollett" role="doc-biblioref">Prentice et al. 2014</a>)</span> formulated such a similar (but not strictly equivalent) optimality criterion as <span class="math display">\[
\frac{\partial (E/A)}{\partial \chi} + \beta \frac{\partial (V_\mathrm{cmax}/A)}{\partial \chi} = 0 \;.
\]</span> <span class="math inline">\(E/A\)</span> is the unit cost of transpiration. <span class="math inline">\(V_\mathrm{cmax}/A\)</span> is the unit cost of carboxylation. Their sum is minimized here with respect to <span class="math inline">\(\chi\)</span>. <span class="math inline">\(\beta\)</span> is the unit cost ratio. From this, the response of the stomatal conductance to <span class="math inline">\(D\)</span> and <span class="math inline">\(A\)</span> can be derived (not shown here, but in <span class="citation" data-cites="stocker20gmd">Stocker et al. (<a href="references.html#ref-stocker20gmd" role="doc-biblioref">2020</a>)</span>) as <span class="math display">\[
g_s = \left( 1 + \frac{g_1}{\sqrt{D}} \right) \frac{A}{c_a - \Gamma^\ast}
\]</span> <span class="math inline">\(g_1\)</span> is a stomatal sensitivity parameter. Similar results are obtained with a related but not identical optimality criterion <span class="citation" data-cites="medlyn11gcb">(<a href="references.html#ref-medlyn11gcb" role="doc-biblioref">Medlyn et al. 2011</a>)</span>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-constlue" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-constlue"><span class="header-section-number">4.5</span> From photosynthesis to light use efficiency</h2>
<p>The light use efficiency model (<a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>) and the FvCB model (<a href="#eq-aj">Equation&nbsp;<span>4.9</span></a> and <a href="#eq-jmaxlim">Equation&nbsp;<span>4.10</span></a>) represent a contrasting response of photosynthesis to light - linear in <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a> and saturating (by effects of a finite <span class="math inline">\(J_\mathrm{max}\)</span>) in <a href="#eq-aj">Equation&nbsp;<span>4.9</span></a> and <a href="#eq-jmaxlim">Equation&nbsp;<span>4.10</span></a>. It should be noted that the LUE model describes the photosynthetic CO<sub>2</sub> uptake at the canopy-level and for periods of multiple days to weeks (total GPP vs.&nbsp;total absorbed light). In contrast, the FvCB model describes the light-photosynthesis relationship at the leaf-level and in response to rapid changes in light (e.g., over the course of a day).</p>
<p>As pointed out in <a href="#sec-fvcb"><span>Section&nbsp;4.3.5</span></a>, plants tend to coordinate the light and carboxylation-limited assimilation rates flexibly in response to average environmental conditions to which they are exposed while performing photosynthesis. Tending towards the co-limitation point can also be understood as an optimal functioning - avoiding overinvestment into maintaining a high maximum electron transport rate (<span class="math inline">\(J_\mathrm{max}\)</span>) while being carboxylation-limited (too low <span class="math inline">\(V_\mathrm{cmax}\)</span>), or the opposite. In other words, the higher the average light levels, the higher the maximum carboxylation capacity and therefore the amount of Rubisco in leaves. The linear relationship between GPP and PPFD in <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a> can be interpreted as an emerging relationship from the coordination of <span class="math inline">\(A_C\)</span> and <span class="math inline">\(A_J\)</span>, and thus of <span class="math inline">\(V_\mathrm{cmax}\)</span> and <span class="math inline">\(J_\mathrm{max}\)</span>.</p>
<p>A very simple model, by which LUE is assumed to be constant over time and across ecosystems and using <a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a> explains about 80% of observed GPP variations in data obtained from ecosystem flux measurements, as shown in <a href="#fig-gpp-constlue">Figure&nbsp;<span>4.13</span></a>. In other words, variations in light (PPFD) and leaf area (measured by fAPAR) explain 80% of GPP variations over the seasons and across different locations on the globe.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hexbin)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>wdf <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/wdf_fdk.rds"</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get absorbed photosynthetically active radiation APAR</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>wdf <span class="ot">&lt;-</span> wdf <span class="sc">|&gt;</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">apar =</span> fapar <span class="sc">*</span> ppfd)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fit linear model of GPP ~ APAR with zero intercept</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>linmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(gpp <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> apar, <span class="at">data =</span> wdf)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>rsq_val <span class="ot">&lt;-</span> <span class="fu">summary</span>(linmod)<span class="sc">$</span>r.squared</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>rsq_lab <span class="ot">&lt;-</span> <span class="fu">format</span>( rsq_val, <span class="at">digits =</span> <span class="dv">2</span> )</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>wdf <span class="sc">|&gt;</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(apar, gpp)) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point(alpha = 0.3) +</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">trans =</span> <span class="st">"log"</span>, <span class="at">option =</span> <span class="st">"magma"</span>, <span class="at">name =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="fu">coef</span>(linmod), <span class="at">linetype=</span><span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"PPFD"</span>  <span class="sc">%*%</span> <span class="st">"fAPAR (mol m"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}, <span class="st">"s"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>)),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"GPP (gC m"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}, <span class="st">"s"</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>)),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">bquote</span>(</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">italic</span>(R)<span class="sc">^</span><span class="dv">2</span> <span class="sc">==</span> .(rsq_lab)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">""</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-gpp-constlue" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gpp_files/figure-html/fig-gpp-constlue-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.13: Observed GPP vs.&nbsp;absorbed photosynthetically active radiation (APAR), defined as the product of LUE and PPFD (<a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a>). Observations are derived from ecosystem CO<sub>2</sub> flux measurements taken at 241 different sites distributed across a wide diversity of ecoystems and environmental conditions. Data is aggregated to weekly means. The adjusted <em>R</em><sup>2</sup> is given at the top and measures the portion of variation explained by APAR. Colors indicate the density of data points. The dotted line represens the leas-squares linear regression with zero intercept. Its slope measures the average LUE.</figcaption>
</figure>
</div>
</div>
</div>
<!-- XXX LES 2: demonstrate that linearity follows from tendency to operate at co-limitation point. -->
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rising CO<sub>2</sub> increases leaf-level photosynthesis. This sensitivity can be quantified using <span class="math inline">\(\beta\)</span> following <a href="globalcarbonbudget.html#eq-beta">Equation&nbsp;<span>3.8</span></a>. Calculate <span class="math inline">\(\beta\)</span> for the light-saturated photosynthesis rate (taking the equation for <span class="math inline">\(A_C\)</span>), considering an increase in atmospheric CO<sub>2</sub> from 400 to 600 ppm. Use <span class="math inline">\(\Gamma^\ast = 3.3\)</span> Pa, <span class="math inline">\(K = 46\)</span> Pa and <span class="math inline">\(V_\mathrm{cmax} = 49 \; \mu\)</span>mol m<sup>-2</sup> s<sup>-1</sup>. Note that <span class="math inline">\(c_a\)</span> in <a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a> is expressed in Pa. Convert an atmospheric CO<sub>2</sub> concentration in units of ppm to Pa by multiplication with 0.101325 Pa ppm<sup>-1</sup> (considering standard atmospheric pressure). Assume that the ratio of ambient-to-leaf-internal CO<sub>2</sub> (<span class="math inline">\(\chi\)</span>) remains constant at 0.7.</p>
<p>Compare your calculated <span class="math inline">\(\beta\)</span> of the light-saturated leaf-level photosynthesis rate with observations from Free Air CO<sub>2</sub> Enrichment (FACE) experiments, as summarized by <span class="citation" data-cites="ainsworth05">Ainsworth and Long (<a href="references.html#ref-ainsworth05" role="doc-biblioref">2005</a>)</span>. For this, download the paper <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1469-8137.2004.01224.x">here</a> and find the reported value for the CO<sub>2</sub> response of the light-saturated leaf-level photosynthesis rate. Convert the percentage increase reported by <span class="citation" data-cites="ainsworth05">Ainsworth and Long (<a href="references.html#ref-ainsworth05" role="doc-biblioref">2005</a>)</span> into a <span class="math inline">\(\beta\)</span> factor. Assume that on average, the CO<sub>2</sub> levels in the FACE experiments were 350 ppm at ambient and 550 ppm at elevated levels.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Symbols
</div>
</div>
<div class="callout-body-container callout-body">

<!-- To copy from book/symbols_gpp.qmd, produced via book/symbols_gpp.csv, edited by hand to convert to qmd table saved as book/symbols_gpp.qmd  -->
<div id="tbl-symbols-gpp" class="anchored">
<table class="table">
<caption>Table&nbsp;4.1: Symbols and abbreviations used in this chapter.</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Symbol/abbreviation</th>
<th>Description</th>
<th>Common units</th>
<th>Equation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GPP</td>
<td>Gross primary production. Ecosystem level photosynthetic CO<sub>2</sub> uptake.</td>
<td>gC m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a></td>
</tr>
<tr class="even">
<td>PPFD</td>
<td>Photosynthetic photon flux density</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a></td>
</tr>
<tr class="odd">
<td>fAPAR</td>
<td>Fraction of absorbed photosynthetically active radiation</td>
<td>(unitless)</td>
<td><a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a></td>
</tr>
<tr class="even">
<td>LUE</td>
<td>Light use efficiency. Ratio of GPP over absorbed photosynthetically active radiation</td>
<td>gC mol<sup>-1</sup></td>
<td><a href="#eq-luemodel">Equation&nbsp;<span>4.1</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(I\)</span></td>
<td>Incident (incoming) solar radiation</td>
<td>W m<sup>-2</sup></td>
<td><a href="#eq-optical-density">Equation&nbsp;<span>4.2</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(I_0\)</span></td>
<td>Incident (incoming) solar radiation at the top of the canopy</td>
<td>W m<sup>-2</sup></td>
<td><a href="#eq-optical-density">Equation&nbsp;<span>4.2</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(k\)</span></td>
<td>Exponential light extinction coefficient</td>
<td>(unitless)</td>
<td><a href="#eq-optical-density">Equation&nbsp;<span>4.2</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(L\)</span>, LAI</td>
<td>Leaf area index</td>
<td>m<sup>2</sup> m<sup>-2</sup></td>
<td><a href="#eq-homogenous-canopy">Equation&nbsp;<span>4.4</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mu\)</span></td>
<td>Optical density</td>
<td>m<sup>-1</sup></td>
<td><a href="#eq-homogenous-canopy">Equation&nbsp;<span>4.4</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(z_0\)</span></td>
<td>Total canopy depth</td>
<td>m</td>
<td><a href="#eq-homogenous-canopy">Equation&nbsp;<span>4.4</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(z\)</span></td>
<td>Canopy depth</td>
<td>m</td>
<td><a href="#eq-optical-density">Equation&nbsp;<span>4.2</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A\)</span></td>
<td>Leaf-level CO<sub>2</sub> assimilation</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(g_s\)</span></td>
<td>Stomatal conductance to CO<sub>2</sub> diffusion</td>
<td></td>
<td><a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(c_i\)</span></td>
<td>Leaf-internal CO<sub>2</sub> concentration. Expressed as a partial pressure</td>
<td>Pa</td>
<td><a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(c_a\)</span></td>
<td>Ambient (atmospheric) CO<sub>2</sub> concentration. Expressed as a partial pressure</td>
<td>Pa</td>
<td><a href="#eq-photo-fick">Equation&nbsp;<span>4.5</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_n\)</span></td>
<td>Leaf-level net CO<sub>2</sub> assimilation after accounting for dark respiration (<span class="math inline">\(R_d\)</span>)</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-net-assimilation">Equation&nbsp;<span>4.7</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(A_C\)</span></td>
<td>Rubisco-carboxylation limited leaf-level CO<sub>2</sub> assimilation rate</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-net-assimilation">Equation&nbsp;<span>4.7</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(A_J\)</span></td>
<td>Electron-transport limited leaf-level CO<sub>2</sub> assimilation rate</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-net-assimilation">Equation&nbsp;<span>4.7</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(R_d\)</span></td>
<td>Leaf dark respiration</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-net-assimilation">Equation&nbsp;<span>4.7</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(V_\mathrm{cmax}\)</span></td>
<td>Maximum rate of Rubisco carboxylation</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-ac">Equation&nbsp;<span>4.8</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(K\)</span></td>
<td>Effective Michaelis-Menten coefficient for <span class="math inline">\(A_C\)</span></td>
<td>Pa</td>
<td><a href="#eq-ac">Equation&nbsp;<span>4.8</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Gamma^\ast\)</span></td>
<td>Photorespiratory compensation point</td>
<td>Pa</td>
<td><a href="#eq-ac">Equation&nbsp;<span>4.8</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(J_\mathrm{max}\)</span></td>
<td>Maximum rate of eletron transport</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-aj">Equation&nbsp;<span>4.9</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(J\)</span></td>
<td>Electron transport rate</td>
<td>mol m<sup>-2</sup> s<sup>-1</sup></td>
<td><a href="#eq-aj">Equation&nbsp;<span>4.9</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\varphi_0\)</span></td>
<td>Quantum yield</td>
<td>mol mol<sup>-1</sup></td>
<td><a href="#eq-aj">Equation&nbsp;<span>4.9</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(E\)</span></td>
<td>Transpiration at the leaf-level</td>
<td>mm s<sup>-1</sup></td>
<td><a href="#eq-transpiration">Equation&nbsp;<span>4.11</span></a></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(D\)</span></td>
<td>Vapour pressure deficit (VPD)</td>
<td>Pa</td>
<td><a href="#eq-transpiration">Equation&nbsp;<span>4.11</span></a></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\chi\)</span></td>
<td>Ratio of leaf-internal to ambient CO<sub>2</sub> concentration</td>
<td>(unitless)</td>
<td><a href="#eq-wue-instantaneous">Equation&nbsp;<span>4.12</span></a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- Exercise:  -->
<!-- - Calculate response ratio of net photosynthesis to a doubling of CO2 (from 400 to 800 ppm). Calculate the beta factor from Chapter 3. Compare to leaf net assimilation from experiments (Walker et al. 2018). -->
<!-- - Keeling et al., 2017 -->
<!-- - leaf energy balance -->
<!-- XXX Box: - FLUXNET data, global upscaling of fluxes -->


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-ainsworth05" class="csl-entry" role="listitem">
Ainsworth, Elizabeth A., and Stephen P. Long. 2005. <span>“What Have We Learned from 15 Years of Free-Air <span>CO2</span> Enrichment (<span>FACE</span>)? <span>A</span> Meta-Analytic Review of the Responses of Photosynthesis, Canopy Properties and Plant Production to Rising <span>CO2</span>.”</span> <em>New Phytologist</em> 165 (2): 351–72. <a href="https://doi.org/10.1111/j.1469-8137.2004.01224.x">https://doi.org/10.1111/j.1469-8137.2004.01224.x</a>.
</div>
<div id="ref-bonan" class="csl-entry" role="listitem">
Bonan, Gordon. 2015. <em>Ecological Climatology: Concepts and Applications</em>. 3rd ed. Cambridge University Press.
</div>
<div id="ref-duursma15plosone" class="csl-entry" role="listitem">
Duursma, Remko A. 2015. <span>“Plantecophys - <span>An</span> <span>R</span> <span>Package</span> for <span>Analysing</span> and <span>Modelling</span> <span>Leaf</span> <span>Gas</span> <span>Exchange</span> <span>Data</span>.”</span> Edited by Paul C. Struik. <em>PLOS ONE</em> 10 (11): e0143346. <a href="https://doi.org/10.1371/journal.pone.0143346">https://doi.org/10.1371/journal.pone.0143346</a>.
</div>
<div id="ref-farquhar80" class="csl-entry" role="listitem">
Farquhar, G D, S von Caemmerer, and J A Berry. 1980. <span>“A Biochemical Model of Photosynthetic <span>CO2</span> Assimilation in Leaves of <span>C</span> 3 Species.”</span> <em>Planta</em> 149 (1): 78–90.
</div>
<div id="ref-jiang20gcb" class="csl-entry" role="listitem">
Jiang, Chongya, Youngryel Ryu, Han Wang, and Trevor F. Keenan. 2020. <span>“An Optimality‐based Model Explains Seasonal Variation in <span>C3</span> Plant Photosynthetic Capacity.”</span> <em>Global Change Biology</em> 26 (11): 6493–6510. <a href="https://doi.org/10.1111/gcb.15276">https://doi.org/10.1111/gcb.15276</a>.
</div>
<div id="ref-joshi22natplants" class="csl-entry" role="listitem">
Joshi, Jaideep, Benjamin D. Stocker, Florian Hofhansl, Shuangxi Zhou, Ulf Dieckmann, and Iain Colin Prentice. 2022. <span>“Towards a Unified Theory of Plant Photosynthesis and Hydraulics.”</span> <em>Nature Plants</em> 8 (11): 1304–16. <a href="https://doi.org/10.1038/s41477-022-01244-5">https://doi.org/10.1038/s41477-022-01244-5</a>.
</div>
<div id="ref-kumarathunge19newphyt" class="csl-entry" role="listitem">
Kumarathunge, Dushan P, Belinda E Medlyn, John E Drake, Mark G Tjoelker, Michael J Aspinwall, Michael Battaglia, Francisco J Cano, et al. 2019. <span>“Acclimation and Adaptation Components of the Temperature Dependence of Plant Photosynthesis at the Global Scale.”</span> <em>New Phytol.</em> 222 (2): 768–84.
</div>
<div id="ref-lambers08" class="csl-entry" role="listitem">
Lambers, Hans, F. Stuart Chapin, and Thijs L. Pons. 2008. <span>“Photosynthesis.”</span> In <em>Plant <span>Physiological</span> <span>Ecology</span></em>, edited by Hans Lambers, F. Stuart Chapin, and Thijs L. Pons, 11–99. New York, NY: Springer. <a href="https://doi.org/10.1007/978-0-387-78341-3_2">https://doi.org/10.1007/978-0-387-78341-3_2</a>.
</div>
<div id="ref-medlyn11gcb" class="csl-entry" role="listitem">
Medlyn, Belinda E., Remko A. Duursma, Derek Eamus, David S. Ellsworth, I. Colin Prentice, Craig V. M. Barton, Kristine Y. Crous, Paolo De Angelis, Michael Freeman, and Lisa Wingate. 2011. <span>“Reconciling the Optimal and Empirical Approaches to Modelling Stomatal Conductance: <span>RECONCILING</span> <span>OPTIMAL</span> <span>AND</span> <span>EMPIRICAL</span> <span>STOMATAL</span> <span>MODELS</span>.”</span> <em>Global Change Biology</em> 17 (6): 2134–44. <a href="https://doi.org/10.1111/j.1365-2486.2010.02375.x">https://doi.org/10.1111/j.1365-2486.2010.02375.x</a>.
</div>
<div id="ref-monteith72" class="csl-entry" role="listitem">
Monteith, J. L. 1972. <span>“Solar <span>Radiation</span> and <span>Productivity</span> in <span>Tropical</span> <span>Ecosystems</span>.”</span> <em>Journal of Applied Ecology</em> 9 (3): 747–66. <a href="http://www.jstor.org/stable/2401901">http://www.jstor.org/stable/2401901</a>.
</div>
<div id="ref-novick16natcc" class="csl-entry" role="listitem">
Novick, Kimberly A., Darren L. Ficklin, Paul C. Stoy, Christopher A. Williams, Gil Bohrer, A. Christopher Oishi, Shirley A. Papuga, et al. 2016. <span>“The Increasing Importance of Atmospheric Demand for Ecosystem Water and Carbon Fluxes.”</span> <em>Nature Climate Change</em> 6 (11): 1023–27. <a href="https://doi.org/10.1038/nclimate3114">https://doi.org/10.1038/nclimate3114</a>.
</div>
<div id="ref-oren01" class="csl-entry" role="listitem">
Oren, R., J. S. Sperry, B. E. Ewers, D. E. Pataki, N. Phillips, and J. P. Megonigal. 2001. <span>“Sensitivity of Mean Canopy Stomatal Conductance to Vapor Pressure Deficit in a Flooded <span>Taxodium</span> Distichum <span>L</span>. Forest: Hydraulic and Non-Hydraulic Effects.”</span> <em>Oecologia</em> 126 (1): 21–29. <a href="https://doi.org/10.1007/s004420000497">https://doi.org/10.1007/s004420000497</a>.
</div>
<div id="ref-prentice14ecollett" class="csl-entry" role="listitem">
Prentice, I. Colin, Ning Dong, Sean M. Gleason, Vincent Maire, and Ian J. Wright. 2014. <span>“Balancing the Costs of Carbon Gain and Water Transport: Testing a New Theoretical Framework for Plant Functional Ecology.”</span> Edited by Josep Penuelas. <em>Ecology Letters</em> 17 (1): 82–91. <a href="https://doi.org/10.1111/ele.12211">https://doi.org/10.1111/ele.12211</a>.
</div>
<div id="ref-stocker20gmd" class="csl-entry" role="listitem">
Stocker, Benjamin D., Han Wang, Nicholas G. Smith, Sandy P. Harrison, Trevor F. Keenan, David Sandoval, Tyler Davis, and I. Colin Prentice. 2020. <span>“P-Model V1.0: An Optimality-Based Light Use Efficiency Model for Simulating Ecosystem Gross Primary Production.”</span> <em>Geoscientific Model Development</em> 13 (3): 1545–81. <a href="https://doi.org/10.5194/gmd-13-1545-2020">https://doi.org/10.5194/gmd-13-1545-2020</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./globalcarbonbudget.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The global carbon budget</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ecosystemcarbon.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ecosystem carbon dynamics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>