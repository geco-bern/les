<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Land in the Earth System I - 1&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./biogeography.html" rel="next">
<link href="./index.html" rel="prev">
<link href="./figures/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Land in the Earth System I - 1&nbsp; Introduction">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/geco-bern/R_book_template/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./biogeography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Biogeography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./carboncycle_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Global carbon pools and fluxes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./carboncycle_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ecosystem carbon fluxes and global patterns</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./carboncycle_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ocean CO<sub>2</sub> uptake and emission-concentration trajectories</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nutrients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Carbon-nutrient cycle interactions and multiple greenhouse gas emissions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./landclimate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Land-climate interactions and water-carbon coupling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ecohydrology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ecohydrology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./globenvchange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Global environmental change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feedbacks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Earth system feedbacks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./landusechange.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Land use change</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reading</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#annual-swings-in-atmospheric-co2" id="toc-annual-swings-in-atmospheric-co2" class="nav-link active" data-scroll-target="#annual-swings-in-atmospheric-co2"><span class="header-section-number">1.1</span> Annual swings in atmospheric CO<sub>2</sub></a></li>
  <li><a href="#year-to-year-changes-of-the-global-carbon-budget" id="toc-year-to-year-changes-of-the-global-carbon-budget" class="nav-link" data-scroll-target="#year-to-year-changes-of-the-global-carbon-budget"><span class="header-section-number">1.2</span> Year-to-year changes of the global carbon budget</a></li>
  <li><a href="#responses-to-rapid-climate-change-in-the-past" id="toc-responses-to-rapid-climate-change-in-the-past" class="nav-link" data-scroll-target="#responses-to-rapid-climate-change-in-the-past"><span class="header-section-number">1.3</span> Responses to rapid climate change in the past</a></li>
  <li><a href="#positive-feedbacks-and-tipping-points" id="toc-positive-feedbacks-and-tipping-points" class="nav-link" data-scroll-target="#positive-feedbacks-and-tipping-points"><span class="header-section-number">1.4</span> Positive feedbacks and tipping points</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>As we drift further away from the domain that characterized the preindustrial Earth system, we severely test the limits of our understanding of how the Earth system will respond.</em> – <span class="citation" data-cites="falkowski00sci">Falkowski et al. (<a href="references.html#ref-falkowski00sci" role="doc-biblioref">2000</a>)</span></p>
<p>The Earth system can be regarded as a coupled system in which its elements (atmosphere, ocean, cryosphere, biosphere, pedosphere, lithosphere) are interacting on various time scales. A primary goal of Earth System research is to understand the interactions occurring on time scales that are relevant for society in the context of anthropogenic climate change. It is now established with overwhelming evidence that anthropogenic CO<sub>2</sub> emissions from the combustion of fossil fuels have caused a rise in atmospheric CO<sub>2</sub> concentrations beyond levels reached over the past 800,000 years, and that this concentration increase is the dominant driver of climate change as observed over the last decades.</p>
<p>The terrestrial biosphere - land - is at the core of the Earth system. It connects all spheres. Atmospheric humidity and near-surface heating of the atmosphere are determined by how much water vegetation transpires and how much radiation it reflects or absorbs. Its carbon balance determines the accumulation of anthropogenic CO<sub>2</sub> in the atmosphere and thus affects the CO<sub>2</sub> gas exchange between the ocean and the atmosphere. The activity of plants is the driver for processes in the soil, the weathering of rocks. Any projection of climate change and climate impacts for the coming decades, centuries and millennia relies on an understanding of how the terrestrial biosphere responds and feeds back to climate and the Earth system. The carbon cycle of the terrestrial biosphere has a strong influence on how fast anthropogenic CO<sub>2</sub> emissions will accumulate in the atmosphere. And it is through land ecosystems - both natural and agricultural - that climate impacts will be most clearly expressed. Understanding how climate influences the terrestrial biosphere is thus key to understanding climate impacts and projecting Earth system change.</p>
<p>This book focuses on the terrestrial biosphere, how its structure and functioning are shaped by climate, and how it affects atmospheric CO<sub>2</sub> and climate change. The following set of phenomena, observations, and popularised concepts are an expression of the key role of the land in the Earth system. Over the course of this book, we will revisit these phenomena, observations, and concepts, introduce the underlying processes and principles for understanding them, and provide a scientific basis to address questions of immanent societal relevance. What is the role of the land biosphere in accelerating climate change (think positive feedbacks and tipping points), and in providing solutions for mitigating it (think forest restoration and other land-based mitigation options).</p>
<section id="annual-swings-in-atmospheric-co2" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="annual-swings-in-atmospheric-co2"><span class="header-section-number">1.1</span> Annual swings in atmospheric CO<sub>2</sub></h2>
<p>The longest-running record of direct measurements of atmospheric CO<sub>2</sub> is from the Mauna Loa Observatory, atop a volcano on Hawaii. This record has become iconic for documenting the rapid rise of atmospheric CO<sub>2</sub> - a greenhouse gas - since the great economic acceleration after the Second World War. This has provided a basis for understanding the relationship between emissions of anthropogenic CO<sub>2</sub> and its accumulation in the atmosphere and for estimating the climate impact of this important greenhouse gas.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mauna-loa-co2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mauna-loa-co2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/co2_data_mlo.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mauna-loa-co2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Atmospheric CO2 from Mauna Loa Observatory, Hawaii. The red curve represents monthly mean values. The black curve represents the same after removing an average seasonal cycle. Source: Dr.&nbsp;Pieter Tans, NOAA/GML (gml.noaa.gov/ccgg/trends/) and Dr.&nbsp;Ralph Keeling, Scripps Institution of Oceanography (scrippsco2.ucsd.edu/).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The time series in <a href="#fig-mauna-loa-co2" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> shows not only the accelerating rise in atmospheric CO<sub>2</sub> over the past decades, but also its regular annual swings - the “breathing of the Earth”. This is the result of the seasonal cycles in CO<sub>2</sub> uptake and release by terrestrial ecosystems. CO<sub>2</sub> uptake peaks in early early summer in the northern extratropics - driven by the high light availability and high photosynthetic rates of young leaves in the early summer months. CO<sub>2</sub> release by respiring plants and soil microbes has a shifted seasonality and tends to have a smaller amplitude, compared to CO<sub>2</sub> uptake. The net of the two drives changes in atmospheric CO<sub>2</sub> which are measured here in the free atmosphere - unaffected by local anthropogenic sources - atop a volcano on Hawaii.</p>
</section>
<section id="year-to-year-changes-of-the-global-carbon-budget" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="year-to-year-changes-of-the-global-carbon-budget"><span class="header-section-number">1.2</span> Year-to-year changes of the global carbon budget</h2>
<p>Anthropogenic carbon emissions in the form of CO<sub>2</sub>, resulting from the combustion of fossil fuels and from land use change, are partly taken up by the ocean and partly by terrestrial ecosystems. The remainder remains in the atmosphere and drives the atmospheric CO<sub>2</sub> growth (see <a href="#fig-mauna-loa-co2" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>). Each of these components gets estimated and updated each year as the <a href="https://globalcarbonbudget.org/carbonbudget2023/">Global Carbon Budget</a>. The latest scientific publication is <span class="citation" data-cites="friedlingstein23essd">Friedlingstein et al. (<a href="references.html#ref-friedlingstein23essd" role="doc-biblioref">2023</a>)</span>.</p>
<p>Estimates of each compenent are largely independent and rely on different types of observations, data, and methods. Fossil emissions are based on energy statistics and cement production data, land use emissions are based on land-use and land-use change data and forest carbon “bookkeeping models”. Atmospheric CO<sub>2</sub> concentration, and hence the accumulation of C in the atmosphere, is measured directly. The ocean sink is estimated from global ocean biogeochemistry models and observation-based products. The land sink is estimated from dynamic global vegetation models <span class="citation" data-cites="friedlingstein23essd">(<a href="references.html#ref-friedlingstein23essd" role="doc-biblioref">Friedlingstein et al. 2023</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-gcb_fig3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gcb_fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/gcb_friedlingstein23_fig3.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gcb_fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: Component fluxes of the annual global carbon budget since 1850. Positive components are emissions to the atmosphere. Carbon emissions get redistributed by the global carbon cycle. This redistribution is governed carbon uptake by the ocean (‘ocean sink’) and carbon uptake by terrestrial ecosystems (‘land sink’), while the remainder accumulates in the atmosphere (‘atmospheric growth’). The dashed red line is mirrored from the solid red line and its difference to the blue line indicates the budget imbalance. All fluxes are given in GtC yr<span class="math inline">\(^{-1}\)</span> (gigatons of carbon per year, 1 Gt = 10<span class="math inline">\(^9\)</span> t = 1 Pg = 10<span class="math inline">\(^{12}\)</span> g). Figure from <span class="citation" data-cites="friedlingstein23essd">Friedlingstein et al. (<a href="references.html#ref-friedlingstein23essd" role="doc-biblioref">2023</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gcb_fig3" class="quarto-xref">Figure&nbsp;<span>1.2</span></a> shows that the largest year-to-year variations in the redistribution of anthropogenic CO<sub>2</sub> emissions is in the land sink component. While variations in the ocean sink and in emissions are relatively small, the carbon balance of the terrestrial biosphere varies strongly between years. This leads to substantial variations in annual atmospheric CO<sub>2</sub> growth rate. Annual variations in the land C balance have been found to originate mostly from semi-arid regions, where large year-to-year variations in precipitation, often linked to El-Nino-Southern-Oscillation climate variability, alter water limitation of vegetation and drought-related disturbances, including fire activity <span class="citation" data-cites="ahlstroem15 humphrey18nat">(<a href="references.html#ref-ahlstroem15" role="doc-biblioref">Ahlström et al. 2015</a>; <a href="references.html#ref-humphrey18nat" role="doc-biblioref">Humphrey et al. 2018</a>)</span>. This leads to large year-to-year variability in CO<sub>2</sub> uptake and release by land ecosystems and leaves an imprint on the rise in atmospheric CO<sub>2</sub>. This also demonstrates the sensitivity of terrestrial C storage to climatic variations and that the response of the land biosphere to climate extremes can drastically alter the accumulation of anthropogenic CO<sub>2</sub> in the atmosphere and thus the rate of climate change.</p>
</section>
<section id="responses-to-rapid-climate-change-in-the-past" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="responses-to-rapid-climate-change-in-the-past"><span class="header-section-number">1.3</span> Responses to rapid climate change in the past</h2>
<p>The climate of the past 11,000 years (11 ka) until the Industrial Revolution was relatively stable, at least in comparison to the climate of the Last Glacial period. This period was marked by millennial-scale climate oscillations where temperatures rose by up to 16<span class="math inline">\(^\circ\)</span>C within a few decades <span class="citation" data-cites="oeschger84 dansgaard93nat">(<a href="references.html#ref-oeschger84" role="doc-biblioref">Oeschger et al. 1984</a>; <a href="references.html#ref-dansgaard93nat" role="doc-biblioref">Dansgaard et al. 1993</a>)</span>. When first discovered in measurments of an ice core recovered from Greenland, the massive excursions of the <span class="math inline">\(\delta^{18}\)</span>O signal - a proxy for air temperature - were considered a measurement error. But the correspondence of similar excursions measured on a different Greenland ice core and the coincidence of the most recent such excursion with a similar pattern found in the <span class="math inline">\(\delta^{18}\)</span>O signal of carbonate in the lake sediment of Gerzensee (near Bern) <span class="citation" data-cites="oeschger84">(<a href="references.html#ref-oeschger84" role="doc-biblioref">Oeschger et al. 1984</a>)</span> confirmed the robustness of these rapid climate change events in the past. Reflecting this, these rapid climate swings between about 80 and 10 ka BP were named Dansgaard-Oeschger events. Today, Dansgaard-Oeschger events are undersood to be oscillations of the Earth system that occurr without external triggers, but arise from the interaction of ocean and ice sheet dynamics, and are confined to Earth system states corresponding to the glacial periods of the late Pleistocene <span class="citation" data-cites="stocker03 vettoretti22natgeo">(<a href="references.html#ref-stocker03" role="doc-biblioref">Stocker and Johnsen 2003</a>; <a href="references.html#ref-vettoretti22natgeo" role="doc-biblioref">Vettoretti et al. 2022</a>)</span>.</p>
<p>The terrestrial biosphere was strongly affected by these large and rapid climate changes and left its imprints in several palaeo records (<a href="#fig-arneth" class="quarto-xref">Figure&nbsp;<span>1.3</span></a>). In response to the climate warming, atmospheric methane (CH<sub>4</sub>) concentrations increased rapidly. Natural CH<sub>4</sub> sources almost exclusively in land ecosystems (wetlands, fire). In parallel, the amount of dust transported to Greenland declined rapidly as climate warmed. This reflects an expansion of vegetation cover into dust-forming regions (e.g., deserts and peri-glacial areas). Also in parallel, nitrous oxide (N<sub>2</sub>O), another greenhouse gas, increased. This increase unfolded more gradually and reflects both oceanic and terrestrial sources. Furthermore, fire activity in the northern hemisphere, measured by charcoal deposits in Greenland ice cores, increased as the climate warmed.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-arneth" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-arneth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/dansgaardoeschger_arneth10natgeo.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-arneth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Ice core and biomass burning records of Earth system changes during Dansgaard-Oeschger events - rapid climate change events during the last Glacial period, between 80 and 10 ka BP (kilo-years, 10<span class="math inline">\(^{3}\)</span> years before present). Shading indicates significant patterns in the response of the time series to the events of abrupt warming and rapid cooling. (a) <span class="math inline">\(\delta^{18}\)</span>O signal is a proxy for air temperature. (b-f) Time series of reconstructed atmospheric greenhouse gas concentrations, dust and fire, temporally aligned and aggregated from subsets of the time series covering multiple Dansgaard-Oeschger events. BYRD: Byrd station, Antarctica; EDC: EPICA Dome C; NGRIP: North Greenland Ice Core Project. Figure from <span class="citation" data-cites="arneth10natgeo">Arneth et al. (<a href="references.html#ref-arneth10natgeo" role="doc-biblioref">2010</a>)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>These variations in land-mediated greenhouse gases, dust, and fire are attest to the large and hemisphere-scale changes in terrestrial biosphere functioning in response to climate variations. Of course, greenhouse gases, dust, and fire-related emissions of CO<sub>2</sub> and aerosols are radiative forcing agents themselves and thus affect the climate. These changes during Dansgaard-Oescher events thus demonstrate the important role of the land biosphere in mediating Earth system changes.</p>
</section>
<section id="positive-feedbacks-and-tipping-points" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="positive-feedbacks-and-tipping-points"><span class="header-section-number">1.4</span> Positive feedbacks and tipping points</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ahlstroem15" class="csl-entry" role="listitem">
Ahlström, Anders, Michael R. Raupach, Guy Schurgers, Benjamin Smith, Almut Arneth, Martin Jung, Markus Reichstein, et al. 2015. <span>“The Dominant Role of Semi-Arid Ecosystems in the Trend and Variability of the Land CO2 Sink.”</span> <em>Science</em> 348 (6237): 895–99.
</div>
<div id="ref-arneth10natgeo" class="csl-entry" role="listitem">
Arneth, A., S. P. Harrison, S. Zaehle, K. Tsigaridis, S. Menon, P. J. Bartlein, J. Feichter, et al. 2010. <span>“Terrestrial Biogeochemical Feedbacks in the Climate System.”</span> <em>Nature Geoscience</em> 3 (8): 525–32. <a href="https://doi.org/10.1038/ngeo905">https://doi.org/10.1038/ngeo905</a>.
</div>
<div id="ref-dansgaard93nat" class="csl-entry" role="listitem">
Dansgaard, W., S. J. Johnsen, H. B. Clausen, D. Dahl-Jensen, N. S. Gundestrup, C. U. Hammer, C. S. Hvidberg, et al. 1993. <span>“Evidence for General Instability of Past Climate from a 250-Kyr Ice-Core Record.”</span> <em>Nature</em> 364 (6434): 218–20. <a href="https://doi.org/10.1038/364218a0">https://doi.org/10.1038/364218a0</a>.
</div>
<div id="ref-falkowski00sci" class="csl-entry" role="listitem">
Falkowski, P., R. J. Scholes, E. Boyle, J. Canadell, D. Canfield, J. Elser, N. Gruber, et al. 2000. <span>“The <span>Global</span> <span>Carbon</span> <span>Cycle</span>: <span>A</span> <span>Test</span> of <span>Our</span> <span>Knowledge</span> of <span>Earth</span> as a <span>System</span>.”</span> <em>Science</em> 290 (5490): 291–96. <a href="https://doi.org/10.1126/science.290.5490.291">https://doi.org/10.1126/science.290.5490.291</a>.
</div>
<div id="ref-friedlingstein23essd" class="csl-entry" role="listitem">
Friedlingstein, P., M. O’Sullivan, M. W. Jones, R. M. Andrew, D. C. E. Bakker, J. Hauck, P. Landschützer, et al. 2023. <span>“Global Carbon Budget 2023.”</span> <em>Earth System Science Data</em> 15 (12): 5301–69. <a href="https://doi.org/10.5194/essd-15-5301-2023">https://doi.org/10.5194/essd-15-5301-2023</a>.
</div>
<div id="ref-humphrey18nat" class="csl-entry" role="listitem">
Humphrey, Vincent, Jakob Zscheischler, Philippe Ciais, Lukas Gudmundsson, Stephen Sitch, and Sonia I. Seneviratne. 2018. <span>“Sensitivity of Atmospheric <span>CO2</span> Growth Rate to Observed Changes in Terrestrial Water Storage.”</span> <em>Nature</em> 560 (7720): 628–31. <a href="https://doi.org/10.1038/s41586-018-0424-4">https://doi.org/10.1038/s41586-018-0424-4</a>.
</div>
<div id="ref-oeschger84" class="csl-entry" role="listitem">
Oeschger, H., J. Beer, U. Siegenthaler, B. Stauffer, W. Dansgaard, and C. C. Langway. 1984. <span>“Late Glacial Climate History from Ice Cores.”</span> <em>Climate Processes and Climate Sensitivity</em>, 299–306. <a href="https://doi.org/10.1029/gm029p0299">https://doi.org/10.1029/gm029p0299</a>.
</div>
<div id="ref-stocker03" class="csl-entry" role="listitem">
Stocker, Thomas F., and Sigfùs J. Johnsen. 2003. <span>“A Minimum Thermodynamic Model for the Bipolar Seesaw.”</span> <em>Paleoceanography</em> 18 (4). <a href="https://doi.org/10.1029/2003PA000920">https://doi.org/10.1029/2003PA000920</a>.
</div>
<div id="ref-vettoretti22natgeo" class="csl-entry" role="listitem">
Vettoretti, Guido, Peter Ditlevsen, Markus Jochum, and Sune Olander Rasmussen. 2022. <span>“Atmospheric <span>CO2</span> Control of Spontaneous Millennial-Scale Ice Age Climate Oscillations.”</span> <em>Nature Geoscience</em> 15 (4): 300–306. <a href="https://doi.org/10.1038/s41561-022-00920-7">https://doi.org/10.1038/s41561-022-00920-7</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link  aria-label=" about="" this="" book"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">About this book</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./biogeography.html" class="pagination-link" aria-label="<span class='chapter-number'>2</span>&nbsp; <span class='chapter-title'>Biogeography</span>">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Biogeography</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>